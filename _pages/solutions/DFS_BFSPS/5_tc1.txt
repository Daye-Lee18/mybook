Test case: 
10 2 2
0 0 0 0 1 0 0 0 0 0
1 0 0 0 0 1 0 0 1 1
0 0 0 0 1 0 1 0 0 1
0 0 0 0 0 1 1 1 1 0
0 0 4 1 0 1 3 3 1 1
0 0 0 1 1 1 3 3 1 1
0 0 0 0 1 1 0 1 1 0
0 0 0 0 0 0 0 0 1 1
0 0 1 0 0 0 0 1 1 0
0 0 0 1 0 0 1 0 1 1
1 1
1 1
1 1
1 1
0 1
0 1
1 0
1 1
0 1
2 0
9 1 2 11
8 4 3 15

Answer:
