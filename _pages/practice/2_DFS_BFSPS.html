
<!DOCTYPE html>


<html lang="ko" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lecture 2-2. DFS/BFS 실습 &#8212; 말레이시아 5급 학생들을 위한 파이썬 알고리즘 수업</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8127ecf8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=ae323b5b"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/translations.js?v=e33e7ba0"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_pages/practice/2_DFS_BFSPS';</script>
    <script src="https://unpkg.com/jupyterquiz@1.1.8/dist/jupyterquiz.min.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="색인" href="../../genindex.html" />
    <link rel="search" title="검색" href="../../search.html" />
    <link rel="next" title="Lecture 3-2. Backtracking 실습" href="3_backtrackingPS.html" />
    <link rel="prev" title="Lecture 1-2. 구현 실습" href="1_implementationPS.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ko"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/mylogo.png" class="logo__image only-light" alt="말레이시아 5급 학생들을 위한 파이썬 알고리즘 수업 - Home"/>
    <script>document.write(`<img src="../../_static/mylogo.png" class="logo__image only-dark" alt="말레이시아 5급 학생들을 위한 파이썬 알고리즘 수업 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="검색" aria-label="검색" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">검색</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to 말레이시아 5급 IT 수업
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">기초</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basics/Input.html">입력</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/oop.html">객체 지향 프로그래밍 (OOP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/oop-classes_instances_objects.html">클래스, 인스턴스, 객체</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/regex.html">정규표현식</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/variable_scope.html">Variable Scope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">이론</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../theory/0_tips.html">문제 풀이 순서 팁 (Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/1_implementation.html">Lecture 1-1. 구현</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/2_DFS_BFS.html">Lecture 2-1. DFS/BFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/3_backtracking.html">Lecture 3-1. Backtracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/4_DP.html">Lecture 4-1. Dynamic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/5_shortest_path.html">Lecture 5-1. Shortest Path</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/6_sort.html">Lecture 6-1. Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/7_binarysearch.html">Lecture 7-1. Binary Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/8_graph.html">Lecture 8-1. Graph Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/9_greedy.html">Lecture 9-1. Greedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/10_prefix.html">Lecture 10-1. Prefix Sum (누적 합)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/11_LinkedList.html">Lecture 11-1. Linked List</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">실습</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_implementationPS.html">Lecture 1-2. 구현 실습</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 2-2. DFS/BFS 실습</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_backtrackingPS.html">Lecture 3-2. Backtracking 실습</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_DPPS.html">Lecture 4-2. DP 실습</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_shortest_pathPS.html">Lecture 5-2. Shortest Path &amp; Heap</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_sortPS.html">Lecture 6-2. Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_linked_listPS.html">Lecture 11-2. Linked List</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">시험</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../exams/midterm_student.html">Midterm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exams/final_student.html">Final</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="이 페이지 다운로드">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/_pages/practice/2_DFS_BFSPS.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="소스 파일 다운로드"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDF로 인쇄"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="전체 화면으로보기"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="검색" aria-label="검색" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 2-2. DFS/BFS 실습</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 내용 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bfs-kit">BFS 고득점 Kit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">타겟 넘버</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">네트워크</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">게임 맵 최단 거리</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">단어 변환</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">아이템 줍기</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">여행 경로</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">퍼즐 조각 채우기</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bfs">BFS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ai">AI 로봇 청소기</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">미생물 연구</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">민트초코 우유</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">메두사와 전사들</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">미지의 공간 탈출</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">마법의 숲 탐색</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">블록 이동하기</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">고대 문명 유적 탐사</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-2-2-dfs-bfs">
<h1>Lecture 2-2. DFS/BFS 실습<a class="headerlink" href="#lecture-2-2-dfs-bfs" title="Link to this heading">#</a></h1>
<p>예시 문제 링크</p>
<ul class="simple">
<li><p>BFS 고득점 Kit</p>
<ul>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/43165">타겟 넘버</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/43162">네트워크</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/1844">게임 맵 최단거리</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/43163">단어 변환</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/87694">아이템 줍기</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/43164">여행 경로</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/84021">퍼즐 조각 채우기</a></p></li>
</ul>
</li>
<li><p>BFS</p>
<ul>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/ai-robot/description">AI 로봇 청소기</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/microbial-research/description">미생물 연구</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/mint-choco-milk/description">민트초코 우유</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/medusa-and-warriors/description">메두사와 전사들</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/escape-unknown-space/description">미지의 공간 탈출</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/magical-forest-exploration/description">마법의 숲 탐색</a></p></li>
<li><p><a class="reference external" href="https://school.programmers.co.kr/learn/courses/30/lessons/60063">블록 이동하기</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/ancient-ruin-exploration/description">고대 문명 유적 탐사</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/destroy-the-turret/description">포탑 부수기</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/codetree-mon-bread/description">코드트리 빵</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/colored-bomb/description">색깔 폭탄</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/rotating-glacier/description">회전하는 빙하</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/autonomous-electric-car/description">자율주행전기차</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/fighting-robot/description">전투로봇</a></p></li>
<li><p><a class="reference external" href="https://www.codetree.ai/ko/frequent-problems/samsung-sw/problems/toast-eggmold/description">토스트 계란틀</a></p></li>
</ul>
</li>
</ul>
<section id="bfs-kit">
<h2>BFS 고득점 Kit<a class="headerlink" href="#bfs-kit" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>타겟 넘버<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Explanation</p>
<p>n개의 음이 아닌 정수
순서를 바꾸지 않고 적절히 더하거나 빼서 타겟 넘버를 만들려고 한다.</p>
<p>parameters:</p>
<ul class="simple">
<li><p>numbers: 사용할 수 있는 숫자가 담긴 배열 2 &lt;= numbers.length &lt;= 20</p></li>
<li><p>target: 타겟넘버 1&lt;= target &lt;= 1000</p></li>
</ul>
<p>return:</p>
<ul class="simple">
<li><p>타겟 넘버를 만드는 방법의 수를 반환</p></li>
</ul>
<p>DFS를 사용하면 branch = 2, depth =N개라, 최악의 경우 2^20개</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="n">depth</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">answer</span>
        <span class="c1"># termination </span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
                <span class="n">answer</span> <span class="o">+=</span> <span class="mi">1</span> 
            <span class="k">return</span> 

        <span class="c1"># branch + / -</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">total</span><span class="o">+</span><span class="n">numbers</span><span class="p">[</span><span class="n">depth</span><span class="p">])</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="n">numbers</span><span class="p">[</span><span class="n">depth</span><span class="p">])</span>

    <span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">answer</span> 

<span class="c1"># numbers = [1, 1, 1, 1, 1]; target=3 # 5</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span> <span class="n">target</span><span class="o">=</span><span class="mi">4</span> <span class="c1"># 2 </span>
<span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="id2">
<h3>네트워크<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>union-find 구조를 이용해 풀이</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">parent</span> 
    <span class="k">if</span> <span class="n">parent</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="n">parent</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">parent</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="c1"># path compression </span>
    <span class="k">return</span> <span class="n">parent</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">union</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">rank</span>
    <span class="n">rootA</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">rootB</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rootA</span> <span class="o">==</span> <span class="n">rootB</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span> 
    <span class="k">if</span> <span class="n">rank</span><span class="p">[</span><span class="n">rootA</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">[</span><span class="n">rootB</span><span class="p">]:</span>
        <span class="n">parent</span><span class="p">[</span><span class="n">rootB</span><span class="p">]</span> <span class="o">=</span> <span class="n">rootA</span> 
        <span class="n">rank</span><span class="p">[</span><span class="n">rootA</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 
    <span class="k">elif</span> <span class="n">rank</span><span class="p">[</span><span class="n">rootA</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">rank</span><span class="p">[</span><span class="n">rootB</span><span class="p">]:</span>
        <span class="n">parent</span><span class="p">[</span><span class="n">rootB</span><span class="p">]</span> <span class="o">=</span> <span class="n">rootA</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">parent</span><span class="p">[</span><span class="n">rootA</span><span class="p">]</span> <span class="o">=</span> <span class="n">rootB</span> 
    <span class="k">return</span> <span class="kc">True</span> 
   


<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">computers</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">GroupCnt</span> 
    <span class="n">GroupCnt</span> <span class="o">=</span> <span class="n">n</span> 
    <span class="n">parent</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span> <span class="c1"># height </span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">end_node</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">computers</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">end_node</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span> 
            <span class="k">else</span><span class="p">:</span> <span class="c1"># 연결되어 있고 </span>
                <span class="k">if</span> <span class="n">union</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">):</span>
                    <span class="n">GroupCnt</span> <span class="o">-=</span> <span class="mi">1</span> 

    <span class="k">return</span> <span class="n">GroupCnt</span> 
</pre></div>
</div>
</div>
</section>
<section id="id3">
<h3>게임 맵 최단 거리<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 


<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">maps</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">maps</span><span class="p">);</span> <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span> 
        <span class="k">return</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;</span><span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span><span class="o">&lt;</span><span class="n">M</span> 
    <span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">visited</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">start_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">start_x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">target_y</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">target_x</span> <span class="o">=</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span> 
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start_y</span><span class="p">,</span> <span class="n">start_x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span> <span class="c1"># y, x, dis </span>
    <span class="c1"># BFS </span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_dis</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="c1"># Early Stopping </span>
        <span class="k">if</span> <span class="n">cur_y</span> <span class="o">==</span> <span class="n">target_y</span> <span class="ow">and</span> <span class="n">cur_x</span> <span class="o">==</span> <span class="n">target_x</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cur_dis</span> 
        
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">nxt_y</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">maps</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]:</span>
                <span class="n">visited</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">,</span> <span class="n">cur_dis</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">))</span>
        
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># 위에서 도달하지 못한 경우 -1를 return </span>


<span class="c1"># maps= [[1,0,1,1,1],[1,0,1,0,1],[1,0,1,1,1],[1,1,1,0,1],[0,0,0,0,1]] # 11 </span>
<span class="n">maps</span><span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>	<span class="c1"># -1 </span>
<span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">maps</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="id4">
<h3>단어 변환<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>“변환 단계 최소 / 간선 개수 최소 / 최소 횟수” → 무조건 BFS 떠올리는 습관</p>
<div class="dropdown admonition">
<p class="admonition-title">Idea</p>
<p>parameters:</p>
<ul class="simple">
<li><p>두 개의 단어 begin, target</p>
<ul>
<li><p>두 단어는 같지 않다.</p></li>
</ul>
</li>
<li><p>단어의 집합 <code class="docutils literal notranslate"><span class="pre">words</span></code>, 3 &lt;= words.length &lt;= 50, 각 단어 3 &lt;= str.length &lt;= 10</p></li>
</ul>
<p>아래의 규칙을 이용하여 begin -&gt; target 변환하는 가장 짧은 변환 과정을 찾으려고 한다.</p>
<ol class="arabic simple">
<li><p>한 번에 한 개의 알파벳만 바꿀 수 있음</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">words</span></code>에 있는 단어로만 변환할 수 있음 (target도 <code class="docutils literal notranslate"><span class="pre">words</span></code>안에 있어야 함.)</p></li>
</ol>
<p>예를 들어, beging이 “hit”이고 target이 “cog”, words = [“hot”, “dot”, “dog”, “lot”, “log”, “cog”]라면
“hit” -&gt; “hot” -&gt; “dot” -&gt; “dog” -&gt; “cog”와 같이 4단계를 거쳐 변환할 수 있다.</p>
<p>return:</p>
<ul class="simple">
<li><p>“최소” 몇 단계의 과정을 거쳐 begin을 target으로 변환할 수 있는 지 return 하도록 solution함수를 작성해주세요.</p></li>
<li><p>변환할 수 없을 때 0을 반환</p></li>
</ul>
<p>Idea:</p>
<ul class="simple">
<li><p>문제에서 “최솟값”을 계산하라고 했으니까, BFS로 접근해보면, 각 단어들을 node로 설정하고</p></li>
<li><p>하나의 char만 다른 값들만 edge 연결시킨다.</p></li>
<li><p>그리고 begin노드에서 target 노드까지 연결된 최소 거리를 측정하면 된다. (shortest path)</p></li>
</ul>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">heapq</span><span class="w"> </span><span class="kn">import</span> <span class="n">heappush</span><span class="p">,</span> <span class="n">heappop</span> 

<span class="n">MAX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e10</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_one_different</span><span class="p">(</span><span class="n">word1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">word2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word2</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span> 
    
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word1</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">word1</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">word2</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
            <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span> 
        <span class="k">if</span> <span class="n">cnt</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span> 
    <span class="k">return</span> <span class="kc">True</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">dijkstra</span><span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="n">target_node</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">shortest_path</span> 

    <span class="n">shortest_path</span><span class="p">[</span><span class="n">start_node</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="n">pq</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="c1"># (E+V) log(V)</span>
    <span class="k">while</span> <span class="n">pq</span><span class="p">:</span>
        <span class="n">cur_dis</span><span class="p">,</span> <span class="n">cur_node</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="n">pq</span><span class="p">)</span> <span class="c1"># VlogV</span>

        <span class="k">if</span> <span class="n">cur_dis</span> <span class="o">&gt;</span> <span class="n">shortest_path</span><span class="p">[</span><span class="n">cur_node</span><span class="p">]:</span>
            <span class="k">continue</span> 

        <span class="k">if</span> <span class="n">cur_node</span> <span class="o">==</span> <span class="n">target_node</span><span class="p">:</span>
            <span class="k">return</span> 
        
        <span class="c1"># Elog(V)</span>
        <span class="k">for</span> <span class="n">nxt_node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">cur_node</span><span class="p">]:</span>
            <span class="n">nxt_dis</span> <span class="o">=</span> <span class="n">cur_dis</span> <span class="o">+</span> <span class="mi">1</span> 
            <span class="k">if</span> <span class="n">nxt_dis</span> <span class="o">&lt;</span> <span class="n">shortest_path</span><span class="p">[</span><span class="n">nxt_node</span><span class="p">]:</span>
                <span class="n">shortest_path</span><span class="p">[</span><span class="n">nxt_node</span><span class="p">]</span> <span class="o">=</span> <span class="n">nxt_dis</span> 
                <span class="n">heappush</span><span class="p">(</span><span class="n">pq</span><span class="p">,</span> <span class="p">(</span><span class="n">nxt_dis</span><span class="p">,</span> <span class="n">nxt_node</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">graph</span><span class="p">,</span> <span class="n">shortest_path</span> 
    <span class="k">if</span> <span class="n">target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># words에 있는 단어들 + begin 단어 </span>
    <span class="n">graph</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    
    <span class="c1"># graph INIT ~ O(N^2)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">words</span><span class="p">):</span> 
        <span class="k">if</span> <span class="n">is_one_different</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
            <span class="n">graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># words안에 있는 단어들은 index +1 (begin이 1증가)</span>
            <span class="n">graph</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">word</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> 
        
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">is_one_different</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
                <span class="n">graph</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">graph</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># ~ O(ElogN)</span>
    <span class="n">shortest_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">MAX</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">dijkstra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">target_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shortest_path</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">shortest_path</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="o">!=</span> <span class="n">MAX</span> <span class="k">else</span> <span class="mi">0</span>


<span class="c1"># begin = &quot;hit&quot;; target=&quot;cog&quot;; words = [&quot;hot&quot;, &quot;dot&quot;, &quot;dog&quot;, &quot;lot&quot;, &quot;log&quot;, &quot;cog&quot;] # 4 </span>
<span class="n">begin</span> <span class="o">=</span> <span class="s2">&quot;hit&quot;</span><span class="p">;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;cog&quot;</span><span class="p">;</span> <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hot&quot;</span><span class="p">,</span> <span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;lot&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="c1"># 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">words</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="id5">
<h3>아이템 줍기<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Idea</p>
<p>이 문제는 그래프를 직접 adjacency list로 그리려고 하면 괴로워진다. 애초에 “정점-간선 그래프”가 아닌 격자 (grid) + BFS로 생각하는게 훨씬 편하다.</p>
<p><img alt="" src="../../_images/12.png" /></p>
<p>위의 상황에서 아래처럼 좌표를 2배로 만들면, 모서리와 안쪽 칸이 분리되어 테두리만 정확히 따라갈 수 있게 된다.</p>
<p><img alt="" src="../../_images/13.png" /></p>
<ol class="arabic simple">
<li><p>좌표를 2배로 키운다.</p>
<ul class="simple">
<li><p>이유: 직사각형들이 꼭짓점만 닿을 때, 대각선으로 잘못 돌아가는 길을 막기 위해</p></li>
<li><p>좌표를 2배로 만들면 “모서리”들이 모두 칸 사이에 생겨서, 테두리만 정확히 따라갈 수 있음</p></li>
</ul>
</li>
<li><p>직사각형들로 2D 맵을 만든다.</p>
<ul class="simple">
<li><p>처음에는 직사각형 전체 영역을 1(지나갈 수 있음)으로 채운다.</p></li>
<li><p>그 다음, 직사각형 내부 (테두리 제외)는 0 (못지나감)으로 채운다.</p></li>
<li><p>이렇게 하면 딱 ‘테두리’만 1로 남음 -&gt; 우리가 갈 수 있는 길은 이 1인 칸들</p></li>
</ul>
</li>
<li><p>캐릭터 위치에서 아이템 위치까지 BFS</p>
<ul class="simple">
<li><p>시작점, 도착점 좌표도 2배로</p></li>
<li><p>상/하/좌/우 네 방향으로만 이동</p></li>
<li><p>1인 칸만 이동 가능</p></li>
<li><p>BFS에서 (처음 아이템에 도달했을 때 거리 /2) 가 정답</p></li>
</ul>
</li>
</ol>
<p>왜 이렇게 하면 효율적인가?</p>
<ul class="simple">
<li><p>좌표가 최대 50이라서, 2배를 해도 최대 100 × 100 정도 격자.</p></li>
<li><p>BFS 한 번 돌려도 O(100 * 100) 정도 → 충분히 빠름.</p></li>
<li><p>직사각형 개수도 많지 않아서, 전체 채우는 것도 O(rectangle 수 * 100 * 100) 이하.</p></li>
<li><p>그래프의 인접 리스트를 만들 필요 없이, 그냥 2D 배열 + BFS로 끝낼 수 있어서 코드도 훨씬 깔끔해.</p></li>
</ul>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>한가지 짚을 점은, 아래 구현에서 range체크를 할 때, <code class="docutils literal notranslate"><span class="pre">0&lt;=nx&lt;=MAX</span></code>로 <code class="docutils literal notranslate"><span class="pre">2&lt;=nx&lt;=MAX</span></code>를 사용하지 않았다. x와 y의 범위는 원래 1&lt;= x, y&lt;=50인데, 이처럼 하는 이유는, graph의 유효 인덱스 범위는 행/열 인덱스: 0~101이기 때문이다.</p>
<p>왜냐하면, grahp[0][..], graph[1][..]은 이미 0인 상태이며 뒤의 range는 넉넉히 해두고 실제 갈 수 있는 상태는 graph[0][..], graph[1][..]의 0/1 상태로 판단하기 때문이다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">characterX</span><span class="p">,</span> <span class="n">characterY</span><span class="p">,</span> <span class="n">itemX</span><span class="p">,</span> <span class="n">itemY</span><span class="p">):</span>
    <span class="c1"># N = 51</span>
    <span class="c1"># 1. 좌표 2배 스케일링  </span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="mi">102</span> 
    <span class="n">graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">MAX</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX</span><span class="p">)]</span>
    <span class="c1"># (x1, y2) ~ (x2, y2)</span>
    <span class="c1"># (x1, y1) ~ (x2, y1)</span>
    <span class="c1">#2-1. 직사각형 전체를 1로 채우기 </span>
    <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangle</span><span class="p">:</span>
        <span class="n">x1</span> <span class="o">*=</span> <span class="mi">2</span> <span class="p">;</span> <span class="n">y1</span> <span class="o">*=</span> <span class="mi">2</span> <span class="p">;</span> <span class="n">x2</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="p">;</span> <span class="n">y2</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="c1"># 직사각형 안에는 다 1로 채우기 </span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> 

    <span class="c1">#2-2. 직사각형 내부는 0으로 지워서 테두리만 남기기 </span>
    <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangle</span><span class="p">:</span>
        <span class="n">x1</span> <span class="o">*=</span> <span class="mi">2</span> <span class="p">;</span> <span class="n">y1</span> <span class="o">*=</span> <span class="mi">2</span> <span class="p">;</span> <span class="n">x2</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="p">;</span> <span class="n">y2</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="c1"># 직사각형 안에는 다 1로 채우기 </span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
                <span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 

    <span class="c1"># 3. BFS로 최단 거리 탐색 </span>
    <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">characterX</span><span class="o">*</span><span class="mi">2</span> <span class="p">,</span> <span class="n">characterY</span><span class="o">*</span><span class="mi">2</span> 
    <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="n">itemX</span><span class="o">*</span><span class="mi">2</span> <span class="p">,</span> <span class="n">itemY</span><span class="o">*</span><span class="mi">2</span> 

    <span class="n">dist</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">MAX</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX</span><span class="p">)]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">sx</span><span class="p">][</span><span class="n">sy</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="c1"># 아이템 위치 도달하면 (2배 스케일링 했으니) 거리 나누기 2 </span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">ex</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="n">ey</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span> 
        
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

            <span class="c1"># 맵 범위 확인 + 테두리(1)만 이동 + 미방문</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nx</span> <span class="o">&lt;=</span> <span class="n">MAX</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ny</span> <span class="o">&lt;=</span> <span class="n">MAX</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="n">ny</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dist</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="n">ny</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">dist</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="n">ny</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> 
                    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>



            
<span class="c1"># rectangle = [[1,1,7,4],[3,2,5,5],[4,3,6,9],[2,6,8,8]]; s_x = 1; s_y=3; item_x = 7; item_y=8 # 17 </span>
<span class="c1"># rectangle = [[1,1,8,4],[2,2,4,9],[3,6,9,8],[6,3,7,7]]; s_x = 9; s_y=7; item_x = 6; item_y=1 # 11</span>
<span class="c1"># rectangle = [[1,1,5,7]]; s_x = 1; s_y=1; item_x = 4; item_y=7 # 9</span>
<span class="c1"># rectangle = [[2,1,7,5],[6,4,10,10]]; s_x = 3; s_y=1; item_x = 7; item_y=10 # 15</span>
<span class="n">rectangle</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]];</span> <span class="n">s_x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">s_y</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">item_x</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">item_y</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># 10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">s_x</span><span class="p">,</span> <span class="n">s_y</span><span class="p">,</span> <span class="n">item_x</span><span class="p">,</span> <span class="n">item_y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="id6">
<h3>여행 경로<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>graph alogirhtm의 오일러 경로를 공부하면 된다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">tickets</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Eulerian Path </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tickets</span><span class="p">:</span>
        <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># Sort</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>
        <span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ICN&quot;</span><span class="p">]</span>
    <span class="n">route</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">last_node</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
        
        <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">last_node</span><span class="p">]:</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="n">last_node</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">route</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">route</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="c1"># tickets = [[&quot;ICN&quot;, &quot;JFK&quot;], [&quot;HND&quot;, &quot;IAD&quot;], [&quot;JFK&quot;, &quot;HND&quot;]] # [&#39;ICN&#39;, &#39;JFK&#39;, &#39;HND&#39;, &#39;IAD&#39;]</span>
<span class="c1"># tickets = [[&quot;ICN&quot;, &quot;SFO&quot;], [&quot;ICN&quot;, &quot;ATL&quot;], [&quot;SFO&quot;, &quot;ATL&quot;], [&quot;ATL&quot;, &quot;ICN&quot;], [&quot;ATL&quot;,&quot;SFO&quot;]] # [&#39;ICN&#39;, &#39;ATL&#39;, &#39;ICN&#39;, &#39;SFO&#39;, &#39;ATL&#39;, &#39;SFO&#39;]</span>
<span class="c1"># tickets = [[&quot;ICN&quot;, &quot;A&quot;], [&quot;ICN&quot;, &quot;B&quot;], [&quot;C&quot;, &quot;ICN&quot;], [&quot;B&quot;, &quot;D&quot;], [&quot;D&quot;, &quot;E&quot;], [&quot;E&quot;, &quot;A&quot;], [&quot;A&quot;, &quot;C&quot;]] # [&#39;ICN&#39;, &#39;A&#39;, &#39;C&#39;, &#39;ICN&#39;, &#39;B&#39;, &#39;D&#39;, &#39;E&#39;, &#39;A&#39;]</span>
<span class="n">tickets</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;ICN&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;ICN&quot;</span><span class="p">]]</span> <span class="c1"># [&#39;ICN&#39;, &#39;A&#39;, &#39;B&#39;, &#39;ICN&#39;]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">tickets</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="id7">
<h3>퍼즐 조각 채우기<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Idea</p>
<ul class="simple">
<li><p>CCW 로 90도 회전하는 경우, 좌표는 다음과 같이 변한다.  (y, x) -&gt; (N-1-x, y)</p></li>
<li><p>문제를 읽어보면 퍼즐 조각과 비어있는 부분은 같은 사이즈일 경우, 그 size에 해당하는 퍼즐 조각과 비어있는 부분의 “모양”이 같은 지 확인해야한다.</p>
<ul>
<li><p>dict[int, list[tuple]]로 채워준다.</p>
<ul>
<li><p>key: size</p></li>
<li><p>value: key에 해당하는 사이즈를 가진, locs: list[tuple]들의 모임</p></li>
</ul>
</li>
<li><p>모양을 확인하기 위해, cell들의 상대적인 위치를 계산하도록 한다.</p>
<ul>
<li><p>좌상단 (y, x)둘다 Min_heap을 기준점으로 하여 나머지 Locs들을 좌상단 (y,x)에 대해서 subtraction을 해주면, 상대적인 위치로 변한다. 이를 sort()하면, 두 리스트가 동일하다면, 모양이 같은 것으로 판명할 수 있다.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>필요한 자료 구조</p>
<ul>
<li><p>empty_spaces</p></li>
<li><p>puzzles_parts</p></li>
<li><p>is_empty_spaces_used</p></li>
</ul>
</li>
</ul>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Explanation</p>
<p>테이블 위에는 “게임 보드”와 “테이블”이 있다.</p>
<ul class="simple">
<li><p>게임보드와 테이블은 모두 각 칸이 1x1 크기인 정사각 격자 모양(NXN)이다.</p>
<ul>
<li><p>0은 빈칸, 1은 이미 채워진 칸</p></li>
<li><p>게임 보드에 퍼즐 조각이 놓일 빈칸 및 table위의 퍼즐조각은 최소 1개에서 6개까지 연결된 형태</p></li>
</ul>
</li>
<li><p>다음 규칙에 따라 “테이블” 위의 퍼즐 조각을 “게임 보드”의 빈칸에 채운다.</p></li>
</ul>
<p>INIT:</p>
<ul class="simple">
<li><p>처음 테이블과 게임보드는 인접한 칸이 닿지 않도록 퍼즐들이 차있다.</p></li>
</ul>
<p>규칙</p>
<ol class="arabic simple">
<li><p>조각은 한 번에 하나씩 채워 넣는다.</p>
<ul class="simple">
<li><p>한 조각이 해당 게임 보드에 들어갈 수 있는 여부 확인 후 다음 조각을 확인해야한다. for loop</p></li>
<li><p>문제는, ‘최대한 많은’ 조각을 채워넣어야한다.</p></li>
<li><p>똑같은 빈칸이라도, 1개를 넣느냐, 여러개를 넣을 수 있느냐에 따라 다른데, 이때 좋은 점은 인접한 칸이 비어있지 않아야 하므로,
한 번 넣을 때 빈 칸이 온전히 꽉차도록 배치해야한다는 것이다. (규칙 4번에 의해)</p></li>
</ul>
</li>
<li><p>조각을 회전시킬 수 있다.</p>
<ul class="simple">
<li><p>4개 가능: 그대로 + Rotate(90도, 180도, 270도)</p></li>
</ul>
</li>
<li><p>조각을 뒤집을 수는 없다.</p></li>
<li><p>“게임 보드”에 “새로” 채워 넣은 퍼즐 조각과 인접한 칸이 비어있으면 안 된다.</p></li>
</ol>
<p>Algorithm</p>
<ol class="arabic simple">
<li><p>game_board을 bfs: 비어있는 곳 확인 ~ O(N^2)</p>
<ul class="simple">
<li><p>dict[int, [list[(y, x)]]: dict[size]에는 넓이가 size만한 비어있는 위치 정보들이 저장되어 있음.</p></li>
</ul>
</li>
<li><p>table 을 bfs: 퍼즐 조각 모양 확인  ~ O(N^2)</p>
<ul class="simple">
<li><p>dict[int, [list[(y, x)]]: dict[size]에는 넓이가 size만한 퍼즐 조각들의 정보들이 저장되어 있음.</p></li>
</ul>
</li>
<li><p>사이즈가 작은 순서대로, puzzles_parts[size]를 탐색.</p></li>
</ol>
<ul class="simple">
<li><p>for size
for 현재 사이즈 퍼즐 조각 idx_p
for 현재 사이즈의 비어있는 공간 idx_e
if is_empty_spaces_used == True:
continue
if (현재 사이즈 퍼즐 조각을 비어있는 공간에 넣을 수 있다): -&gt; 현재 모양, 90, 180, 270에 대해서 돌렸을 때의 모양까지 확인
total += 1
break # 넣을 수 있으면 현재 퍼즐 조각에 대해서 여기서 끝내야함</p></li>
</ul>
<p>return:</p>
<ul class="simple">
<li><p>규칙에 맞게 최대한 많은 퍼즐 조각을 채워 넣을 경우, 총 몇 칸을 채울 수 있는지 return 하도록 solution 함수를 완성해라.</p></li>
</ul>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span> <span class="p">,</span> <span class="n">deque</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">heapq</span><span class="w"> </span><span class="kn">import</span> <span class="n">heappush</span><span class="p">,</span> <span class="n">heappop</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">N</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">N</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">BFS</span><span class="p">(</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">graph</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">puzzles_parts</span><span class="p">,</span> <span class="n">empty_spaces</span><span class="p">,</span> <span class="n">is_empty_spaces_used</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    floodfill을 하면서, 조건에 맞는 곳을 Visited에 삽입시킨다. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">DY</span><span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">))</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">)])</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="c1"># start 위치인 (s_y, s_x)에 대해 &quot;상대적인 위치&quot; 저장 </span>
        <span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cur_y</span> <span class="o">-</span> <span class="n">s_y</span><span class="p">,</span> <span class="n">cur_x</span> <span class="o">-</span> <span class="n">s_x</span><span class="p">))</span> 
        <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span> 

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="p">;</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="k">continue</span> 

            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    
    <span class="n">locs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># 정렬 y-min, x-min 정렬 </span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 채워져있는 칸을 찾는 puzzle parts를 찾는다면, </span>
        <span class="n">puzzles_parts</span><span class="p">[</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">locs</span><span class="p">[:])</span> <span class="c1"># slicing </span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># 비어있는 칸을 찾는 다면, </span>
        <span class="n">empty_spaces</span><span class="p">[</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">locs</span><span class="p">[:])</span>
        <span class="n">is_empty_spaces_used</span><span class="p">[</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">make_locs_relative_locs</span><span class="p">(</span><span class="n">locs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    이미 정렬된 Locs를 받음</span>
<span class="sd">    in-place로 상대적 위치로 변환 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)):</span>
        <span class="n">locs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">locs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ref_y</span><span class="p">,</span> <span class="n">locs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ref_x</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">can_fit</span><span class="p">(</span><span class="n">puzzle_parts_locs</span><span class="p">,</span> <span class="n">empty_locs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    두 Parameters들은 각 조각/비어있는 곳에 대한 </span>
<span class="sd">    (0, 0)에 대한 상대적 위치로 저장되어 있음. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">global</span> <span class="n">N</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">puzzle_parts_locs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_locs</span><span class="p">)</span>

    <span class="n">before_locs</span> <span class="o">=</span> <span class="n">puzzle_parts_locs</span><span class="p">[:]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># puzzle_parts 4번의 rotation </span>
        <span class="c1"># 모든 puzzle_parts의 현재 locs에 대하여 s</span>
        <span class="n">after_locs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">before_locs</span><span class="p">:</span> <span class="c1"># before_locs의 원소양이 바뀌면 안되므로, temp_locs에 대신 채워넣음. </span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">x</span> <span class="o">=</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">after_locs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>  
        

        <span class="n">before_locs</span> <span class="o">=</span> <span class="n">after_locs</span><span class="p">[:]</span> <span class="c1"># Update 다음 90도 CCW를 위해 </span>

        <span class="c1"># 회전된 좌표들에 대해 좌표들의 &#39;상대적 위치&#39;가 동일한지 확인 </span>
        <span class="c1"># empty_locs는 한 번 만들면 변하지 않고, 이미 상대적 위치들이 정렬되어 있음.  </span>
        <span class="n">after_locs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> 
        <span class="n">make_locs_relative_locs</span><span class="p">(</span><span class="n">after_locs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">empty_locs</span> <span class="o">==</span> <span class="n">after_locs</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span> 
    <span class="k">return</span> <span class="kc">False</span> 




<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">game_board</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">empty_spaces</span><span class="p">,</span> <span class="n">puzzles_parts</span><span class="p">,</span> <span class="n">is_empty_spaces_used</span><span class="p">,</span> <span class="n">N</span>
    <span class="n">empty_spaces</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">puzzles_parts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">is_empty_spaces_used</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> <span class="c1"># False/True </span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Step 1. BFS로 empty_spaces와 puzzles_parts를 size별로 위치 정보 계산 </span>
    <span class="n">empty_spaces_visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">puzzles_parts_visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">empty_spaces_visited</span> <span class="ow">and</span> \
                <span class="n">game_board</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 비어져있는 칸이 비어있는 곳 </span>
                <span class="n">BFS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">empty_spaces_visited</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">game_board</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">puzzles_parts_visited</span> <span class="ow">and</span> \
                <span class="n">table</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 채워져있는 칸이 puzzle parts </span>
                <span class="n">BFS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">puzzles_parts_visited</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

    <span class="c1"># Step 2. 사이즈 별로, puzzles_parts[size]를 탐색 </span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">puzzles_parts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">puzzle_locs</span> <span class="ow">in</span> <span class="n">puzzles_parts</span><span class="p">[</span><span class="n">size</span><span class="p">]:</span> <span class="c1"># 모든 퍼즐에 대하여 </span>
            <span class="k">if</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">empty_spaces</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">idx_e</span><span class="p">,</span> <span class="n">empty_locs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">empty_spaces</span><span class="p">[</span><span class="n">size</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">is_empty_spaces_used</span><span class="p">[</span><span class="n">size</span><span class="p">][</span><span class="n">idx_e</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">continue</span> 
                    <span class="k">if</span> <span class="n">can_fit</span><span class="p">(</span><span class="n">puzzle_locs</span><span class="p">,</span> <span class="n">empty_locs</span><span class="p">):</span>
                        <span class="n">total</span> <span class="o">+=</span> <span class="n">size</span> <span class="c1"># &quot;총 몇 칸을 채울 수 있는지&quot;</span>
                        <span class="n">is_empty_spaces_used</span><span class="p">[</span><span class="n">size</span><span class="p">][</span><span class="n">idx_e</span><span class="p">]</span><span class="o">=</span> <span class="kc">True</span> 
                        <span class="k">break</span> <span class="c1"># 찾았으면 맞는 빈 공간 찾는 것을 중단하고, 다음 puzzle 조각으로 넘어가야함. </span>

                    
    <span class="k">return</span> <span class="n">total</span> 
</pre></div>
</div>
</div>
</section>
</section>
<section id="bfs">
<h2>BFS<a class="headerlink" href="#bfs" title="Link to this heading">#</a></h2>
<section id="ai">
<h3>AI 로봇 청소기<a class="headerlink" href="#ai" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">실수한 부분</p>
<p>이런 BFS문제를 풀 때, 각 격자가 가질 수 있는 상태의 수가 매우 중요함. 변화하는 상태에 대해서 update할 때 확인해야 할 것이 무엇인지 알 수 있기 때문</p>
<p>각 격자는
(1) 먼지가 있거나: 먼지의 양(p) 1 &lt;= graph[y][x] &lt;= 100 로 존재.
(2) 아무런 먼지가 없거나: graph[y][x] == 0
(3) 물건이 위치할 수 있음: graph[y][x] == -1
(4) 청소기 위치: vaccume_list[id].y, vaccume_list[id].x, locs_vaccume_set: set(tuple)
-&gt; 청소기의 위치를 나타내는 2차원 배열을 따로 만들어서 관리 B[r][c] = robot.num</p>
<p>이번 문제에서, 가장 큰 오류는 clean() 함수에서 존재하였다.</p>
<ul class="simple">
<li><p>청소할 ‘방향’을 결정할 때, 현재 그래프의 먼지량 총합의 기준이 아니라, “청소할 수 있는”먼지 총합을 기준으로 방향을 설정했어야했다.</p></li>
<li><p>즉, 한 격자당 20 먼지량을 청소할 수 있으므로 총 합을 구할 때 min(20, A[r][c])로 구해야하는데, 그냥 A[r][c]을 계산해서 틀렸음.</p></li>
</ul>
<p>또한 시간을 가장 많이 잡아먹는 부분이 move()의 BFS 함수에서 존재하였다.</p>
<ul class="simple">
<li><p>현재 로봇 청소기 위치에 먼지가 있으면 움직이지 않아도 된다. 라는 부분이 잘 명시되어 있지 않아서 헷갈렸다.</p></li>
<li><p>가장 가까운 오염거리에 대한 위치 계산을 할 때, 모든 오염 셀에 대한 거리를 계산하는 게 아니라, 로봇 위치에서 가장 가까운 격자의 거리를 계산하면 그 다음은 break를 하는 것이 훨씬 빠른데, 전자의 방법을 사용하여 시간 초과 에러를 받았다.</p></li>
</ul>
<p>마지막으로, constraints에 대한 time complexity계산을 어느 정도 한 뒤에 알고리즘을 짜야하는데, 너무 급하게 구현을 한 것 같다.</p>
</div>
<div class="admonition-solution admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span> 

<span class="c1"># sys.stdin = open(&quot;Input.txt&quot;)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Robot</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">num</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span> 


<span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">robots</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">rb</span> <span class="o">=</span> <span class="n">Robot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">robots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rb</span><span class="p">)</span>
    <span class="n">B</span><span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">][</span><span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">num</span>

<span class="c1"># 4방(좌,상,우,하) + (0,0) 유지(청소 시 자기 칸 포함용)</span>
<span class="n">dxys</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">N</span>

<span class="k">def</span><span class="w"> </span><span class="nf">move</span><span class="p">(</span><span class="n">rb</span><span class="p">:</span> <span class="n">Robot</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">][</span><span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> 
    
    <span class="n">nearest</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="n">best_D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 

    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">))</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">][</span><span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">best_D</span> <span class="o">!=-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">best_D</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]:</span>
            <span class="k">break</span> 

        <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="n">dxys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">dx</span> 
            <span class="n">nc</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">dy</span> 
            
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dist</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> \
            <span class="n">A</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">B</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">dist</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> 
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">best_D</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">best_D</span> <span class="o">==</span> <span class="n">dist</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]):</span>
                    <span class="n">best_D</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span>
                    <span class="n">nearest</span> <span class="o">=</span> <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="k">if</span> <span class="n">nearest</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">min</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">),</span> <span class="n">nearest</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">nearest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">B</span><span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">][</span><span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 
        <span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">nearest</span> 
        <span class="n">B</span><span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">][</span><span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">num</span>


<span class="c1"># def clean(rb:Robot) -&gt; None :</span>
<span class="c1">#     max_sum = 0</span>
<span class="c1">#     best_no_dxy = None </span>

<span class="c1">#     # 하나의 로봇당 4방향에 대해 </span>
<span class="c1">#     for no_dxy in dxys[:-1]:  # 4방 중 제외할 방향 하나를 고른다</span>
<span class="c1">#         s = 0</span>
<span class="c1">#         for dx, dy in dxys:   # 자기 칸(0,0) + 4방</span>
<span class="c1">#             r, c = rb.r + dx, rb.c + dy</span>
<span class="c1">#             if in_range(r, c) and (dx, dy) != no_dxy:</span>
<span class="c1">#                 s += min(20, max(0, A[r][c])) # A[r][c]가 -1인 경우 대비하여 max(0, A[r][c])</span>

<span class="c1">#         if max_sum &lt; s:</span>
<span class="c1">#             max_sum = s </span>
<span class="c1">#             best_no_dxy = no_dxy </span>
    
<span class="c1">#     if max_sum &gt; 0:</span>
<span class="c1">#         for dx, dy in dxys:</span>
<span class="c1">#             r, c = rb.r + dx, rb.c + dy</span>
<span class="c1">#             if in_range(r, c) and (dx, dy) != best_no_dxy and A[r][c] &gt; 0:</span>
<span class="c1">#                 A[r][c] = max(0, A[r][c] - 20)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="n">rb</span><span class="p">:</span><span class="n">Robot</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">removed_dir</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">}</span>


    <span class="n">cells_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
        <span class="mi">1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="p">}</span>

    <span class="n">DR</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">DC</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># 5가지 방향에 대한 총합 </span>
    <span class="n">five_sums</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">r</span><span class="p">][</span><span class="n">rb</span><span class="o">.</span><span class="n">c</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="n">DR</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">c</span> <span class="o">+</span> <span class="n">DC</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ac</span><span class="p">)</span> <span class="ow">and</span> <span class="n">A</span><span class="p">[</span><span class="n">ar</span><span class="p">][</span><span class="n">ac</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span><span class="c1"># NOTE: -1이면 five_sum이 잘못 구해짐 </span>
            <span class="n">five_sums</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">ar</span><span class="p">][</span><span class="n">ac</span><span class="p">]</span>
    
    <span class="n">max_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_dir</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">removed_dir</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">cur_sum</span> <span class="o">=</span> <span class="n">five_sums</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">c</span> <span class="o">+</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">rr</span><span class="p">,</span> <span class="n">rc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">A</span><span class="p">[</span><span class="n">rr</span><span class="p">][</span><span class="n">rc</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># NOTE: -1이면 cur_sum이 잘못 빼짐 </span>
            <span class="n">cur_sum</span> <span class="o">-=</span> <span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">rr</span><span class="p">][</span><span class="n">rc</span><span class="p">],</span> <span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cur_sum</span> <span class="o">&gt;</span> <span class="n">max_sum</span><span class="p">:</span>
            <span class="n">max_sum</span> <span class="o">=</span> <span class="n">cur_sum</span> 
            <span class="n">max_dir</span> <span class="o">=</span> <span class="n">key</span> 
    
    <span class="k">if</span> <span class="n">max_sum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">cells_dict</span><span class="p">[</span><span class="n">max_dir</span><span class="p">]:</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">c</span> <span class="o">+</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">A</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">A</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">increase</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;먼지 축적: 모든 먼지 칸(+5). 물건(-1)이나 0칸은 변화 없음.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">5</span>


<span class="k">def</span><span class="w"> </span><span class="nf">spread</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    먼지 확산:</span>
<span class="sd">      - 깨끗한 칸(=0)으로만 확산됨.</span>
<span class="sd">      - 각 깨끗한 칸은 인접 4방의 &#39;먼지 양 합&#39; // 10 만큼 증가.</span>
<span class="sd">      - 동시 적용을 위해 temp 누적 후 일괄 반영.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="n">dxys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">dy</span>
                    <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">and</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
                <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span> <span class="o">//</span> <span class="mi">10</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>



<span class="k">def</span><span class="w"> </span><span class="nf">total_dust</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;현재 격자 내 총 먼지량 합산(&gt;0인 칸만).&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">A</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="c1"># L 라운드 시뮬레이션</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="c1"># 1) 이동: 로봇 번호 순서대로</span>
    <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="n">robots</span><span class="p">:</span>
        <span class="n">move</span><span class="p">(</span><span class="n">rb</span><span class="p">)</span>

    <span class="c1"># 2) 청소: 로봇 번호 순서대로</span>
    <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="n">robots</span><span class="p">:</span>
        <span class="n">clean</span><span class="p">(</span><span class="n">rb</span><span class="p">)</span>

    <span class="c1"># 3) 먼지 축적</span>
    <span class="n">increase</span><span class="p">()</span>

    <span class="c1"># 4) 먼지 확산</span>
    <span class="n">spread</span><span class="p">()</span>

    <span class="c1"># 5) 총 먼지 출력 + 조기 종료</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">total_dust</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</section>
<section id="id8">
<h3>미생물 연구<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Explanation</p>
<p>미생물 연구</p>
<p>필요한 자료구조</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">graph</span></code>: 현재 미생물의 위치를 저장한다. graph[y][x] = microbe_id , 아무것도 없으면 0으로 저장 (INIT)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">does_id_exist:</span> <span class="pre">[bool]</span></code> = does_id_exit[id] = True/False로 저장 해당 미생물 id가 죽었는지 살았는지 체크</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id_to_locs:</span> <span class="pre">dict[int,</span> <span class="pre">list]</span></code> = 미생물들은 삽입되거나 제거되므로 add()뒤에 move()를 시작할 때 항상 계속 갱신</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id_to_new_graph_origin:</span> <span class="pre">dict[int,</span> <span class="pre">Tuple[int]]</span></code>: move()이후에 id마다의 locs 재계산은 time consuming하므로 move()할때 새로 옮긴 origin을 저장해두어, record()때 이웃 미생물 검사시에 사용한다.</p></li>
<li><p>배양 크기 NxN (0, 0) ~ (N, N), 0-indexed , N+1개</p>
<ul>
<li><p>0 &lt;= x,y &lt; N (inclusive, exclusive)</p></li>
<li><p>좌하단이 (0, 0)이며 (x, y)로 표시</p></li>
</ul>
</li>
<li><p>총 Q번의 실험 진행하며 각 실험의 결과를 기록</p></li>
</ul>
<ol class="arabic simple">
<li><p>미생물 투입 (add) ~ O(N) + O(N)</p></li>
</ol>
<ul class="simple">
<li><p>(r1, c1, r2, c2)의 직사각형 여역에 한 무리의 미생물 투입</p>
<ul>
<li><p>graph[y][x] = microbe_id 저장한다.</p></li>
<li><p>does_id_exist = [True] # id는 1부터 시작하므로, 맨 앞은 [True]로 저장</p></li>
<li><p>does_id_exist.append(True)</p></li>
</ul>
</li>
<li><p>원래 자리에 다른 미생물이 존재하면 새로 투입된 미생물의 영역 내의 미생물들을 잡아먹는다.</p>
<ul>
<li><p>원래 뭐가 있어도 현재 microbe_id로 저장한다.</p></li>
<li><p>이때 기존에 있는 미생물 id를 <code class="docutils literal notranslate"><span class="pre">removed_id</span> <span class="pre">=</span> <span class="pre">set()</span></code>에 저장해둔다.</p></li>
</ul>
</li>
<li><p>즉, 영역 내에는 새로 투입된 미생물만 남게된다.</p></li>
<li><p>만약 기존에 있던 어떤 미생물 무리 A가 새로 투입된 미생물 무리 B에게 잡아먹혀서 영역이 2이상으로 나눠진 경우에는, 기존 미생물은 전부 사라진다.</p>
<ul>
<li><p>map을 돌면서 해당 미생물 id의 그룹 수가 2이상이면 모두 제거 가능</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">does_id_exist[id]:</span> <span class="pre">list[int]</span></code> = True/False에서 False 로 저장한다.</p></li>
</ul>
</li>
<li><p>X: (아래에서 다시 셀 것임) 만약 그룹 수가 2이상이 아니라면, 기존에 있던 <code class="docutils literal notranslate"><span class="pre">id_to_locs:</span> <span class="pre">list[set]</span></code>의 set에서 id_to_locs[id].remove(locs)로 해당 위치를 지워준다.</p></li>
</ul>
</li>
</ul>
<p>–&gt; 위의 문제는 뭐냐면, 기존에 있던 배양용기에서 뭔가가 사라지면, pq안에서 순서가 제대로 된 것이 없어지게 된다.
–&gt; 이 때 또 graph를 돌면서 해당 id에 대해 계산해야하기때문에, step 2 (move)에서 한번에 계산하는게 더 편리할 것</p>
<ol class="arabic simple" start="2">
<li><p>배양 용기 이동 (move)</p></li>
</ol>
<ul class="simple">
<li><p>모든 미생물을 새로운 배양 용기로 이동시킴. (NxN)</p>
<ul>
<li><p>new_graph를 생성한다. (임시)</p></li>
</ul>
</li>
<li><p>기존 배양 용기에 있는 무리 중 가장 차지한 영역이 넓은 무리를 하나 선택 -&gt; 동일한 영역이면, 가장 먼저 투입된 미생물을 선택한다.</p>
<ul>
<li><p>Priority queue / sort</p></li>
<li><p>기존 graph를 돌면서, (len(locs), id)정보를 저장하고, 이를 pq에 다 넣는다.</p>
<ul>
<li><p>새롭게 INIT된 빈 id_to_locs: dict(int, list)</p></li>
<li><p>이 과정에서 <code class="docutils literal notranslate"><span class="pre">id_to_locs[id].append()</span></code>하여 locs 위치 정보를 파악해놓는다.</p></li>
<li><p>위에서 pq에 바로 넣는 식으로하면, 예전에 pq에 미리 넣어놨던 것에서 미생물의 영역이 작아지는 경우에는 tracking하기가 어려우므로 다시 센다.</p></li>
<li><p>list.sort()로 한다.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>선택된 미생물 무리를 새 배양 용기에 옮긴다. (new_graph)</p>
<ul>
<li><p>이때 무리는 기존 용기에서의 “형태를 유지”해야한다.</p>
<ul>
<li><p>해당 무리의 cell 좌표를 모두 가지고 있다가, origin이 바뀌면 그만큼 “평행이동”해준다.</p></li>
</ul>
</li>
<li><p>배양 용기의 범위를 벗어나지 않아야 한다.</p>
<ul>
<li><p>in_range() 함수</p></li>
</ul>
</li>
<li><p>다른 미생물의 영역과 겹치지 않도록 두어야한다.</p>
<ul>
<li><p>check(): 해당 id_to_locs[id]에 있는 모든 위치에서 new_graph의 모든 지점이 0이여야함.</p></li>
</ul>
</li>
<li><p>위의 조건 안에서 x좌표가 최대한 작은 위치로 미생물을 옮겨야 하며, 그런 위치가 둘 이상이라면 최대한 y좌표가 작은 위치로 오도록 미생물을 옮긴다.</p>
<ul>
<li><p>(최대한 ‘좌측하단의 좌표’가 배양 용기의 좌측하단에 오도록 위치)</p></li>
<li><p>미생물 id안에서 좌측하단의 좌표를 항상 알고 있는 것이 좋음</p></li>
<li><p>같은 x에서는 작은 y : for x (for y)</p></li>
<li><p>새로 옮겨진 위치는 (기존 위치 - 좌측하단 위치)</p></li>
</ul>
</li>
</ul>
</li>
<li><p>위의 조건을 만족하지 못하여 어떤 곳에도 둘 수 없으면, 새 용기에 옮기지 않고 사라진다.</p>
<ul>
<li><p>does_id_exist[id] = False 로 저장</p></li>
</ul>
</li>
</ul>
<p>graph = new_graph[:] # 슬라이싱</p>
<ol class="arabic simple" start="3">
<li><p>실험 결과 기록 (record)</p></li>
</ol>
<ul class="simple">
<li><p>미생물 무리 중 상하좌우로 맞닿은 면이 있는 무리끼리는 ‘인접한 무리’</p>
<ul>
<li><p>인접한 무리 쌍을 저장한다. (1, 2), (2, 3)</p></li>
<li><p>새로 옮겨진 위치에서 인접한지 확인한다.
total = 0
pair_set = set()
for id in id_to_locs:
if does_id_exist[id]:
id_to_locs[모든 위치] - lower_bottom_loc[id]의 4방향에 다른 id가 있으면, 인접
graph[dx][dy] != 0 and graph[dx][dy] != id:
인접
if (id1, id2) in pair_set or (id2, id1) in pair_set:
continue
total += len(id_to_locs[id1]) * len(id_to_locs[id2])
pair_set.add((id1, id2))</p></li>
</ul>
</li>
<li><p>모든 ‘인접한 무리’ “쌍” 을 확인한다.</p></li>
<li><p>(A,B)와 (B,A)는 같은 쌍임</p></li>
<li><p>미생물 A의 영역의 넓이 x 미생물 B의 영역의 넓이만큼의 성과를 얻고 -&gt; 이를 다 “더한” 값 (누적합)을 기록해야한다.</p></li>
</ul>
<p>constraints:</p>
<ul class="simple">
<li><p>2 &lt;= N &lt;= 15</p></li>
<li><p>1 &lt;= Q &lt;= 50</p></li>
</ul>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span><span class="p">,</span> <span class="n">defaultdict</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">heapq</span><span class="w"> </span><span class="kn">import</span> <span class="n">heappush</span><span class="p">,</span> <span class="n">heappop</span> 

<span class="c1"># sys.stdin = open(&quot;Input.txt&quot;)</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span>

<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">N</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">N</span>

<span class="k">def</span><span class="w"> </span><span class="nf">BFS</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">start_y</span><span class="p">,</span> <span class="n">cur_id</span><span class="p">,</span> <span class="n">visited</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span>

    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">start_x</span><span class="p">,</span> <span class="n">start_y</span><span class="p">))</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">start_y</span><span class="p">)])</span>

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_y</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">nxt_y</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxt_x</span><span class="p">][</span><span class="n">nxt_y</span><span class="p">]</span> <span class="o">==</span> <span class="n">cur_id</span><span class="p">:</span>
                    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">))</span>
                    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">))</span>

            
<span class="k">def</span><span class="w"> </span><span class="nf">count_group_bfs</span><span class="p">(</span><span class="n">cur_id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">graph</span> 
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">cur_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">BFS</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cur_id</span><span class="p">,</span> <span class="n">visited</span><span class="p">)</span>
                <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span> 
    <span class="k">return</span> <span class="n">cnt</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">graph</span><span class="p">,</span> <span class="n">does_id_exist</span>
    <span class="n">removed_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="c1"># Step1: 새롭게 투입된 미생물 graph에 삽입 </span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">):</span> <span class="c1"># upper right : exclusive </span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">removed_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
            <span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="nb">id</span>

    <span class="n">does_id_exist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 새로운 id있으면 삽입 </span>
    <span class="c1"># lower_bottom_coord[id] = (r1, c1)</span>
    
    <span class="c1"># Step 2: 앞선 지워진 기존 미생물의 그룹 수가 2개 이상인지 확인 </span>
    <span class="k">for</span> <span class="n">is_removed_id</span> <span class="ow">in</span> <span class="n">removed_set</span><span class="p">:</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">count_group_bfs</span><span class="p">(</span><span class="n">is_removed_id</span><span class="p">)</span>
        <span class="c1"># NOTE: 그룹 수가 아예없을 때도 False로 바꾸어주어야한다. </span>
        <span class="k">if</span>  <span class="n">cnt</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">does_id_exist</span><span class="p">[</span><span class="n">is_removed_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
            <span class="c1"># 기존에 있던 location의 정보 다 삭제 </span>

<span class="k">def</span><span class="w"> </span><span class="nf">move</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">N</span><span class="p">,</span> <span class="n">id_to_locs</span><span class="p">,</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">does_id_exist</span><span class="p">,</span> <span class="n">id_to_new_graph_origin</span>
    <span class="n">new_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">sort_pq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">id_to_locs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> <span class="c1"># NOTE: 이전과 헷갈리지 않게 reinit </span>

    <span class="c1"># Stpe1. 각 id에 대해서 Locs에 대해 조사 </span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="c1"># 현재 아이디 = graph[x][y]에 대해서 방문하지 않았던 것이면 </span>
            <span class="c1"># 또한, add()함수에서 지워진, 미생물에 대해서 다시 0으로 만들지 않았으므로 </span>
            <span class="c1"># does_id_exist[id]에 대해서도 현재 살아있는 것인지 lazy validtaion을 진행한다. </span>
            <span class="n">cur_id</span> <span class="o">=</span> <span class="n">graph</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> 
            <span class="k">if</span> <span class="n">cur_id</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="n">does_id_exist</span><span class="p">[</span><span class="n">cur_id</span><span class="p">]:</span>
                <span class="c1"># cur_id = graph[x][y]</span>
                <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

                <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
                    <span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_y</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
                    <span class="c1"># 새로운 것을 만날 때마다 </span>
                    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span> 
                    <span class="c1"># 예전 미생물이 다른 미생물한테 어느 정도 먹혀서 제일 작은 coordinate이 다를 수도 있음. </span>
                    <span class="n">heappush</span><span class="p">(</span><span class="n">id_to_locs</span><span class="p">[</span><span class="n">cur_id</span><span class="p">],</span> <span class="p">(</span><span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_y</span><span class="p">))</span> <span class="c1"># min_heap, x와 y모두 </span>
                    <span class="c1"># id_to_locs[id].append((cur_x, cur_y)) </span>

                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                        <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                        <span class="n">nxt_y</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

                        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">):</span>
                            <span class="k">continue</span> 
                        <span class="k">if</span> <span class="p">(</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxt_x</span><span class="p">][</span><span class="n">nxt_y</span><span class="p">]</span> <span class="o">==</span> <span class="n">cur_id</span><span class="p">:</span>
                            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">))</span>
                            <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">))</span>
                <span class="c1"># 다 돌았으면 </span>
                <span class="n">heappush</span><span class="p">(</span><span class="n">sort_pq</span><span class="p">,</span> <span class="p">(</span><span class="n">cnt</span><span class="o">*-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cur_id</span><span class="p">))</span> <span class="c1"># cnt에 대해서는 max heap, cur_id에 대해서 min_heap </span>

    <span class="c1"># Step2. 미생물을 새로운 배양 용기에 옮김 </span>
    <span class="k">while</span> <span class="n">sort_pq</span><span class="p">:</span>
        <span class="n">cur_area</span><span class="p">,</span> <span class="n">cur_id</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="n">sort_pq</span><span class="p">)</span>
        <span class="n">cur_area</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="n">locs</span> <span class="o">=</span> <span class="n">id_to_locs</span><span class="p">[</span><span class="n">cur_id</span><span class="p">]</span>
        <span class="n">ref_coord</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        NOTE: flag, found를 사용할 때, for loop이나 while loop이 여러개 중첩되어 있는 경우, </span>
<span class="sd">        반드시 &quot;모든 경우의 수&quot;에 대해서 for/while loop이 끝났을 경우, 결과가 어떻게 되는지 확인하여 flag 처리를 각별히 주의해준다. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># x좌표가 제일 작고, 같은 x위치가 2개이면, y의 위치가 작아야한다. </span>
        <span class="k">for</span> <span class="n">origin_x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">origin_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">new_graph</span><span class="p">[</span><span class="n">origin_x</span><span class="p">][</span><span class="n">origin_y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span> 
                <span class="c1"># 현재 cur_id에 대해 모든 locs에서 미생물을 옮길 수 있는지 확인 </span>
                <span class="n">dif_x</span> <span class="o">=</span> <span class="n">ref_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">origin_x</span> 
                <span class="n">dif_y</span> <span class="o">=</span> <span class="n">ref_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">origin_y</span>
                
                <span class="n">found</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">cur_loc</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
                    <span class="n">new_x</span> <span class="o">=</span> <span class="n">cur_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dif_x</span>
                    <span class="n">new_y</span> <span class="o">=</span> <span class="n">cur_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dif_y</span>

                    <span class="c1"># 조건1. 배양 용기의 범위를 벗어나지 않아야 함. </span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_range</span><span class="p">(</span><span class="n">new_x</span><span class="p">,</span> <span class="n">new_y</span><span class="p">):</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">break</span> 
                    <span class="c1"># 조건 2. 다른 미생물의 영역과 겹치지 않도록 두기 </span>
                    <span class="k">if</span> <span class="n">new_graph</span><span class="p">[</span><span class="n">new_x</span><span class="p">][</span><span class="n">new_y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">break</span> 
                <span class="c1"># 만약 위의 모든 locs에 대해서 만족하였더라면, 옮길 수 있음 </span>
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="n">id_to_new_graph_origin</span><span class="p">[</span><span class="n">cur_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">origin_x</span><span class="p">,</span> <span class="n">origin_y</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">cur_loc</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
                        <span class="n">new_x</span> <span class="o">=</span> <span class="n">cur_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dif_x</span>
                        <span class="n">new_y</span> <span class="o">=</span> <span class="n">cur_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dif_y</span>
                        <span class="n">new_graph</span><span class="p">[</span><span class="n">new_x</span><span class="p">][</span><span class="n">new_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">cur_id</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># default로 0으로 해놓고 찾았을 때만 1로 해야함. 만약 default로 1 해놓으면, 아무것도 못찾고 그냥 끝나버림 </span>
                    <span class="k">break</span> <span class="c1"># for문 break</span>
                <span class="c1"># else:</span>
                <span class="c1">#     # 조건을 만족하지 못한 미생물은 사라져야함. </span>
                <span class="c1">#     does_id_exist[cur_id] = False </span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">does_id_exist</span><span class="p">[</span><span class="n">cur_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
    <span class="c1"># Step 3: </span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">new_graph</span><span class="p">[:]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">record</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">id_to_locs</span><span class="p">,</span> <span class="n">does_id_exist</span><span class="p">,</span> <span class="n">id_to_new_graph_origin</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">DX</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

    
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">does_id_exist</span><span class="p">)):</span>
        <span class="c1"># 모든 id 에 대하여 인접한 곳에 다른 id 가 있으면, </span>
        <span class="k">if</span> <span class="n">does_id_exist</span><span class="p">[</span><span class="nb">id</span><span class="p">]:</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="n">id_to_locs</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="c1"># move하기 전의 locations </span>
            <span class="n">ref_coord</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dif_x</span> <span class="o">=</span> <span class="n">ref_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">id_to_new_graph_origin</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dif_y</span> <span class="o">=</span> <span class="n">ref_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">id_to_new_graph_origin</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">pair_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="c1"># 하나의 id에 다른 id가 존재하는 경우 </span>
            <span class="k">for</span> <span class="n">loc_x</span><span class="p">,</span> <span class="n">loc_y</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
                <span class="n">new_x</span> <span class="o">=</span> <span class="n">loc_x</span> <span class="o">-</span> <span class="n">dif_x</span> 
                <span class="n">new_y</span> <span class="o">=</span> <span class="n">loc_y</span> <span class="o">-</span> <span class="n">dif_y</span> 

                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                    <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">new_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                    <span class="n">nxt_y</span> <span class="o">=</span> <span class="n">new_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_x</span><span class="p">,</span> <span class="n">nxt_y</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxt_x</span><span class="p">][</span><span class="n">nxt_y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">nxt_id</span> <span class="o">=</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxt_x</span><span class="p">][</span><span class="n">nxt_y</span><span class="p">]</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="n">nxt_x</span><span class="p">][</span><span class="n">nxt_y</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">nxt_id</span> <span class="ow">in</span> <span class="n">pair_set</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">does_id_exist</span><span class="p">[</span><span class="n">nxt_id</span><span class="p">]:</span>
                                <span class="n">pair_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">nxt_id</span><span class="p">)</span>
                                <span class="n">total</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_to_locs</span><span class="p">[</span><span class="nb">id</span><span class="p">])</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_to_locs</span><span class="p">[</span><span class="n">nxt_id</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">total</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># (A, B) 와 (B, A)는 동일하므로 /2 로 나눠줌. </span>


<span class="n">N</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">필요한 자료구조 </span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">does_id_exist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="n">id_to_locs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> <span class="c1"># id_to_locs[id] = [항상 맨 앞에 lower-left loc]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">id_to_new_graph_origin</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Q</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># microbe_id는 1부터 시작, graph가 0이면 아무것도 없음.</span>
    <span class="c1"># if id == 4:</span>
    <span class="c1">#     print(&#39;a&#39;) </span>
    <span class="n">r1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

    <span class="n">add</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
    <span class="n">move</span><span class="p">()</span>
    <span class="n">record</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">test case</p>
<ol class="arabic simple">
<li></li>
</ol>
<p>8 4 <br>
2 2 5 6<br>
2 3 5 8<br>
2 0 5 3<br>
1 1 6 6<br></p>
<ol class="arabic simple" start="2">
<li></li>
</ol>
<p>3 3<br>
0 0 3 2 <br>
1 0 3 3<br>
2 2 3 3<br></p>
<ol class="arabic simple" start="3">
<li></li>
</ol>
<p>8 5<br>
0 0 2 5<br>
1 1 5 6<br>
1 0 3 6<br>
7 7 8 8<br>
2 4 6 7<br></p>
<ol class="arabic simple" start="4">
<li></li>
</ol>
<p>6 6 <br>
3 4 5 5<br>
3 3 4 4<br>
2 0 3 1<br>
0 2 1 4<br>
1 4 3 6<br>
5 0 6 2<br></p>
</div>
</section>
<section id="id9">
<h3>민트초코 우유<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">heapq</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_trust</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">trust</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">print_food</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">food</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Student</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trust</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 신앙심</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defence</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 방어</span>
    <span class="c1">#</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">trust</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">trust</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Group</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">food</span><span class="p">):</span>
        <span class="c1"># 대표 좌표, 대표 음식</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="n">food</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">member</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        대표자 정하기 &amp; trust set</span>
<span class="sd">        대표자: trust up -&gt; r down -&gt; c down</span>
<span class="sd">        대표자.trust += 그룹원 -1</span>
<span class="sd">        팀원.trust -= 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">trust</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">trust</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="c1">#</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_group_member</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="n">food2bin</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">N</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">breakfast</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - 모든 학생의 trust += 1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">stu</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
            <span class="n">stu</span><span class="o">.</span><span class="n">trust</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="n">dr</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span> <span class="n">sc</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">sr</span><span class="p">,</span> <span class="n">sc</span><span class="p">)])</span>
    <span class="n">group</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">sr</span><span class="p">][</span><span class="n">sc</span><span class="p">])</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="n">v</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">dc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">or</span> <span class="n">v</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="ow">or</span> <span class="n">board</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span><span class="o">.</span><span class="n">food</span> <span class="o">!=</span> <span class="n">food</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
            <span class="n">v</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">group</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">v</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lunch</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - 인접한 학생들과 신봉 음식이 같은 경우 그룹 형성</span>
<span class="sd">    - 대표자: trust up -&gt; r down -&gt; c down</span>
<span class="sd">    - 대표자.trust += 그룹원 -1</span>
<span class="sd">    - 팀원.trust -= 1</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">group_lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="c1"># 그룹 형성</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">food</span><span class="p">)</span>
            <span class="n">visited</span> <span class="o">=</span> <span class="n">bfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">food</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">visited</span><span class="p">)</span>
            <span class="n">group_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="c1"># 대표자 정하기 &amp; trust set</span>
            <span class="n">group</span><span class="o">.</span><span class="n">set_manager</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">group_lst</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_order</span><span class="p">(</span><span class="n">group_lst</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    [1] 전파 순서 정하기</span>
<span class="sd">    - 전파 순서: 단일 -&gt; 이중 -&gt; 삼중 그룹</span>
<span class="sd">        - 대표자의 B up -&gt; 대표자의 r down -&gt; c down</span>
<span class="sd">    :return order_lst</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">order_lst</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># 단일/이중/삼중</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">group_lst</span><span class="p">:</span>
        <span class="c1"># 삼중인 경우</span>
        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">food</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">order_lst</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c1"># 단일 인 경우</span>
        <span class="k">elif</span> <span class="n">g</span><span class="o">.</span><span class="n">food</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">order_lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># 이중인 경우</span>
            <span class="n">order_lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">order_lst</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">strong_spread</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spreader</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="n">target</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="n">spreader</span><span class="o">.</span><span class="n">food</span>
    <span class="n">x</span> <span class="o">-=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">trust</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">target</span><span class="o">.</span><span class="n">trust</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span><span class="w"> </span><span class="nf">weak_spread</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spreader</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">spreader</span><span class="o">.</span><span class="n">food</span> <span class="o">&gt;&gt;</span> <span class="n">food</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">target</span><span class="o">.</span><span class="n">food</span> <span class="o">&gt;&gt;</span> <span class="n">food</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">target</span><span class="o">.</span><span class="n">food</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">food</span><span class="p">)</span>
    <span class="n">target</span><span class="o">.</span><span class="n">trust</span> <span class="o">+=</span> <span class="n">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span><span class="w"> </span><span class="nf">do_spread</span><span class="p">(</span><span class="n">spreader</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    [2] 전파하기</span>
<span class="sd">    - 전파자</span>
<span class="sd">        - 전파 방향: trust % 4</span>
<span class="sd">        - x: B-1(간절함), B = 1check</span>
<span class="sd">    - 전파 시작</span>
<span class="sd">        - 전파 방향으로 1칸씩 이동하며 전파</span>
<span class="sd">        - 격자 밖으로 나가거나 x = 0이 되면 전파 종료</span>
<span class="sd">        - 전파 음식이 타겟음식과 같으면 전파 X, 다음 진행</span>
<span class="sd">        - 다르면, 전파 수행</span>
<span class="sd">    [3] 전파 방법</span>
<span class="sd">    - y: 타겟의 trust</span>
<span class="sd">    - 강한 전파(x &gt; y):</span>
<span class="sd">        - 타겟.food = 전파.food</span>
<span class="sd">        - 전파.x -= y+1</span>
<span class="sd">        - 타겟.trust += 1</span>
<span class="sd">    - 약한 전파 (x &lt;= y):</span>
<span class="sd">        - 타겟.food |= 전파자.food   (있는지 확인 필요)</span>
<span class="sd">        - 타겟.trust += x</span>
<span class="sd">        - 전파.x = 0</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">spreader</span><span class="o">.</span><span class="n">trust</span> <span class="o">%</span> <span class="mi">4</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">spreader</span><span class="o">.</span><span class="n">trust</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">spreader</span><span class="o">.</span><span class="n">trust</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">spreader</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">spreader</span><span class="o">.</span><span class="n">c</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">nr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">dc</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">target</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">food</span> <span class="o">^</span> <span class="n">spreader</span><span class="o">.</span><span class="n">food</span><span class="p">:</span>  <span class="c1"># 두 음식이 다를 때만 전파 진행</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">trust</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">strong_spread</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spreader</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">weak_spread</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spreader</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="n">target</span><span class="o">.</span><span class="n">defence</span> <span class="o">=</span> <span class="n">t</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dinner</span><span class="p">(</span><span class="n">group_lst</span><span class="p">):</span>
    <span class="c1"># 전파 순서 정하기</span>
    <span class="n">order_lst</span> <span class="o">=</span> <span class="n">set_order</span><span class="p">(</span><span class="n">group_lst</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">order_lst</span><span class="p">:</span>
        <span class="n">order</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">spreader</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spreader</span><span class="o">.</span><span class="n">defence</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">:</span>
                <span class="n">do_spread</span><span class="p">(</span><span class="n">spreader</span><span class="p">)</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_result</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TCM, TC, TM, CM, M, C, T 순으로 각 음식의 신봉자들의 신앙심 총합 출력</span>
<span class="sd">    &#39;T&#39;: 0,</span>
<span class="sd">    &#39;C&#39;: 1,</span>
<span class="sd">    &#39;M&#39;: 2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">8</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">stu</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
            <span class="n">result</span><span class="p">[</span><span class="n">stu</span><span class="o">.</span><span class="n">food</span><span class="p">]</span> <span class="o">+=</span> <span class="n">stu</span><span class="o">.</span><span class="n">trust</span>

    <span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TCM&#39;</span><span class="p">,</span> <span class="s1">&#39;TC&#39;</span><span class="p">,</span> <span class="s1">&#39;TM&#39;</span><span class="p">,</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]:</span>
        <span class="n">key_food</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">food</span><span class="p">:</span>
            <span class="n">key_food</span> <span class="o">|=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">food2bin</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">key_food</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">stu</span> <span class="o">=</span> <span class="n">Student</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
        <span class="n">food</span> <span class="o">=</span> <span class="n">food2bin</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="n">column</span><span class="p">]]</span>
        <span class="n">stu</span><span class="o">.</span><span class="n">food</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">food</span><span class="p">)</span>
        <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">stu</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">trust</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">breakfast</span><span class="p">()</span>

    <span class="n">GROUP_LST</span> <span class="o">=</span> <span class="n">lunch</span><span class="p">()</span>

    <span class="n">dinner</span><span class="p">(</span><span class="n">GROUP_LST</span><span class="p">)</span>

    <span class="n">print_result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">list.sort() vs. heapq</p>
<p>어디서 틀렸나? 사실 잘 모르겠음.</p>
<p>중요한 건, 보통의 경우는 list.sort()를 사용하고 아래와 같은 경우에만 min-heap을 쓴다. 왜냐면 min-heap의 pop()이후 다시 heapify하는데 시간이 걸리기 때문.</p>
<ul class="simple">
<li><p>간선이 스트리밍으로 들어오거나 한 번에 다 만들기 어려운 상황(외부 입력/온라인 처리)</p></li>
<li><p>“가장 싼 간선부터 일부만” 처리하며 중간에 조기 종료가 확실한 특수 케이스</p></li>
</ul>
</div>
</section>
<section id="id10">
<h3>메두사와 전사들<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Bottleneck constraints 관리</p>
<p>이 문제에서는 전사의 명수가 메모리/시간 차원에서 가장 큰 bottleneck이 된다. 따라서, 이러한 전사들의 위치와 생사문제를 관리하는 것이 중요해진다. 따라서, 해당 warriors들은 class Warrior로 전사마다 하나씩 만드는 행위는 매우 위험하다. 클래스 자체는 메모리를 많이 차지하기 때문에, 이것보다는 list[idx]차원으로 관리해주는 것이 더 유리하다.</p>
<blockquote>
<div><p>war_ys: list[int] # war_ys[war_id] = y
war_xs: list[int] # war_xs[war_id] = x
alive: list[bool] # alive[war_id] = True
warriors_graph: dict[tuple(int, int), list[int]] defaultdict(list) # warriors_graph[(y, x)] = [war_id1, war_id2, …]</p>
</div></blockquote>
</div>
<div class="dropdown admonition">
<p class="admonition-title">메두사의 시야각</p>
<p>특정 전사에 의해 메두사에게 가려지는 범위는 메두사와 해당 전사의 상대적인 위치에 의해 결정된다. 상하좌우 대각선 8방향을 나누었을 때, 메두사로부터 8방향 중 한 방향에 전사가 위치해있다면, 그 전사가 “동일한 방향으로 바라본 범위”에 포함된 모든 칸은 메두사에게 보이지 않습니다.</p>
<p><img alt="" src="../../_images/145.png" /></p>
<p>또한, 메두사의 전체 시야각을 계산할 때, 아래와 같은 상황이 있으므로, 순차적으로 메두사의 전체 시야각을 1로 지정한뒤, 전사들의 시야각을 바라보는 “방향”에 맞춰 0으로 제거해주는 것이 포인트가 된다.</p>
<p><img alt="" src="../../_images/155.png" /></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span><span class="p">,</span> <span class="n">defaultdict</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span> 

<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span> 
<span class="c1"># sys.stdin = open(&quot;Input.txt&quot;)</span>

<span class="c1"># 마을의 크기 N, 전사의 수 M</span>
<span class="n">N</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="c1"># 메두사의 집 위치, 공원 위치 </span>
<span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">,</span> <span class="n">e_y</span><span class="p">,</span> <span class="n">e_x</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="c1"># 상하좌우 우선순위 </span>
<span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">필요한 자료구조</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">warriors_graph</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> <span class="c1"># dict((y, x) -&gt; list of idx) 현재 전사들의 위치 관리, (y,x)위치에 -&gt; idx 보관</span>
<span class="n">MAX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
<span class="n">distances_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MAX</span><span class="p">]</span> <span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">war_ys</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span> 
<span class="n">war_xs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span>
<span class="n">alive</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span> 
<span class="n">visited</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]</span> <span class="c1"># 전사들이 이동할 때, 메두사의 매 turn마다 set()을 초기화하는 것은 메모리 사용량이 많아지므로, 계속 초기화 하면서 관리한다. </span>

<span class="k">class</span><span class="w"> </span><span class="nc">Medusa</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">set_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> 
<span class="c1"># --------------</span>

<span class="n">medusa_object</span> <span class="o">=</span> <span class="n">Medusa</span><span class="p">(</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">)</span>

<span class="c1"># 전사의 시작 위치 </span>
<span class="n">warriors_locs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">warriors_locs</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">warriors_locs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">warriors_locs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">war_ys</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span> 
    <span class="n">war_xs</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> 
    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span> 
    

<span class="c1"># 마을 도로 정보 </span>
<span class="n">graph</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span> <span class="c1"># 도로 0, 비도로 1 </span>

<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">N</span> 
    <span class="k">return</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">N</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_distances</span><span class="p">():</span><span class="c1"># distances_graph를 채움 </span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e_y</span><span class="p">,</span> <span class="n">e_x</span><span class="p">))</span>
    <span class="n">distances_graph</span><span class="p">[</span><span class="n">e_y</span><span class="p">][</span><span class="n">e_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span><span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">distances_graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="n">MAX</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">distances_graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">=</span> <span class="n">distances_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> 
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>


<span class="c1"># 메두사의 집에서 공원까지 최단 경로 파악, weight이 1인 graph에서는 BFS사용 가능 </span>
<span class="c1"># 즉, dijkstra algorithm에서 graph의 edge weight=1인 특수 케이스가 BFS   </span>
<span class="k">def</span><span class="w"> </span><span class="nf">dijkstra</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span> <span class="p">,</span> <span class="n">e_y</span><span class="p">,</span> <span class="n">e_x</span><span class="p">,</span> <span class="n">distances_graph</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">))</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">))</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span> 

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">cury</span><span class="p">,</span> <span class="n">curx</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="c1"># path.append((cury, curx))</span>
        
        <span class="k">if</span> <span class="n">cury</span> <span class="o">==</span> <span class="n">e_y</span> <span class="ow">and</span> <span class="n">curx</span> <span class="o">==</span> <span class="n">e_x</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span> 
            <span class="k">break</span> 
        
        <span class="n">cur_dis</span> <span class="o">=</span> <span class="n">distances_graph</span><span class="p">[</span><span class="n">cury</span><span class="p">][</span><span class="n">curx</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">cury</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">curx</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> \
                <span class="n">cur_dis</span> <span class="o">&gt;</span> <span class="n">distances_graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]:</span> <span class="c1"># 도로로만 이동가능, distances_graph는 0/1 도로/비도로 상황을 고려하여 도착점까지의 거리를 계산한 그래프로, 해당 길이 있다면, 항상 더 거리가 짧은 다음 노드가 존재하게 됨. </span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span><span class="n">nx</span><span class="p">))</span>
                <span class="k">break</span> <span class="c1"># 하나의 방향을 상/하/좌/우로 찾았으면 바로 다음 길 찾으면 됨. </span>
                
                    
    <span class="k">return</span> <span class="n">path</span> <span class="k">if</span> <span class="n">flag</span> <span class="k">else</span> <span class="n">deque</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_vision</span><span class="p">(</span><span class="n">medusa_y</span><span class="p">,</span> <span class="n">medusa_x</span><span class="p">):</span>
    <span class="c1"># direction : 상하좌우 </span>
    <span class="n">max_cnt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">return_vision_map</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_dir</span> <span class="o">=</span> <span class="kc">None</span> 

    <span class="n">VISION_DXYS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="c1"># 상 t= 0, dy = -1</span>
        <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="c1"># 하 t= 1, dy = 1</span>
        <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="c1"># 좌 t = 2 , dx = -1</span>
        <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="c1"># 우 t = 3 , dx = 1 </span>
    <span class="p">]</span>
    <span class="c1"># 4가지 방향에 대해서 </span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        전사의 수는 최대 300명이 될 수 있는데, 그렇게 되면, 아래의 데이터 구조가 너무 많아서, 메모리가 터질 수 있다.</span>
<span class="sd">        따라서, 하나의 vision map만 만들어서, 관리한다. </span>
<span class="sd">        즉, 별도의 Locs_set 두개는 사용하지 않음. </span>

<span class="sd">        Algorithm </span>
<span class="sd">        q는 BFS에서 현재 위치, </span>
<span class="sd">        warrior_pq는 시야각에 있던 전사들의 모음 </span>
<span class="sd">        vision[y][x]는 메두사의 시야를 나타냄 1: 시야각에 존재. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># all_possible_locs_set = set()</span>
        <span class="c1"># all_warrior_blocks_set = set()</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
        <span class="n">vision</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>  <span class="c1"># 해당 격자가 메두사의 시야각에 위치하면 1이됨. 이걸로 visited 도 판별 가능 </span>
        <span class="n">warrior_pq</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span> 
        <span class="n">warrior_cnt</span> <span class="o">=</span> <span class="mi">0</span> 

        <span class="c1"># q INIT </span>
        <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">medusa_y</span> <span class="o">+</span> <span class="n">VISION_DXYS</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="nb">dir</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">medusa_x</span> <span class="o">+</span> <span class="n">VISION_DXYS</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="nb">dir</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vision</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">dir</span><span class="p">))</span>
                <span class="n">vision</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> 
                
                <span class="k">if</span> <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)]:</span>
                    <span class="c1"># lazy_deletion_warriors_graph(ny, nx)</span>
                    <span class="c1"># if warriors_graph:</span>
                    <span class="n">warrior_pq</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">dir</span><span class="p">))</span>

        <span class="c1"># 모든 시야각 vision에 채움 </span>
        <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
            <span class="n">cury</span><span class="p">,</span> <span class="n">curx</span><span class="p">,</span> <span class="n">curdir</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

            <span class="c1"># 메두사로부터 내려온 방향에 그대로 사용하도록 </span>
            <span class="c1"># NOTE: 각 cell을 방문할 때 중복이 없도록 하는 것이 포인트! 만약에 3방향 모두 허용하면, 겹쳐서 틀리게됨. </span>
            <span class="k">if</span> <span class="n">curdir</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># dy / dx = -1 </span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># inclusive ~ exclusive </span>
            <span class="k">elif</span> <span class="n">curdir</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># exclusive </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># exclusive </span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span> 
                <span class="n">nxt_y</span> <span class="o">=</span> <span class="n">cury</span> <span class="o">+</span> <span class="n">VISION_DXYS</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">curx</span> <span class="o">+</span> <span class="n">VISION_DXYS</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># 해당 격자가 아직 시야각에 없는 경우 0의 값을 가짐 </span>
                <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vision</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">,</span> <span class="n">curdir</span><span class="p">))</span> <span class="c1"># curdir는 계속 가지고 있음. </span>
                    <span class="n">vision</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 메두사 시야각에 존재 </span>
                    <span class="c1"># all_possible_locs_set.add((nxt_y, nxt_x))</span>
                <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)]:</span>
                    <span class="c1"># lazy_deletion_warriors_graph(nxt_y, nxt_x)</span>
                    <span class="c1"># if warriors_graph:</span>
                    <span class="n">warrior_pq</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">,</span> <span class="n">curdir</span><span class="p">))</span>

        <span class="c1"># 해당 warrior로부터 가려지는 부분 다시 지움 </span>
        <span class="k">while</span> <span class="n">warrior_pq</span><span class="p">:</span>
            <span class="n">cury</span><span class="p">,</span> <span class="n">curx</span><span class="p">,</span> <span class="n">curdir</span> <span class="o">=</span> <span class="n">warrior_pq</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">curdir</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># dy / dx = -1 </span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># inclusive ~ exclusive </span>
            <span class="k">elif</span> <span class="n">curdir</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># exclusive </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># exclusive </span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span> <span class="c1"># 0, 1</span>
                <span class="n">nxt_y</span> <span class="o">=</span> <span class="n">cury</span> <span class="o">+</span> <span class="n">VISION_DXYS</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">curx</span> <span class="o">+</span> <span class="n">VISION_DXYS</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vision</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 현재 코드에서 전개하는 방향들에 대해서 겹치는 부분이 있을 수 없으므로 (nxt_y, nxt_x) in all_possible_locs_set 조건 체크는 불필요 </span>
                    <span class="n">warrior_pq</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">,</span> <span class="n">curdir</span><span class="p">))</span>
                    <span class="n">vision</span><span class="p">[</span><span class="n">nxt_y</span><span class="p">][</span><span class="n">nxt_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># 다시 가리기 </span>

        <span class="c1"># 최종 방향 t에서 메두사 시야각은 vision에 담아있음 </span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">vision</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 시야에 있는데 </span>
                    <span class="k">if</span> <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)]:</span> <span class="c1"># 그 시야안에 전사들이 있다면, </span>
                        <span class="n">cnt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">warriors_graph</span><span class="p">[(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)])</span> <span class="c1"># 이미 lazy deletion됐음. </span>
                        <span class="n">warrior_cnt</span> <span class="o">+=</span> <span class="n">cnt</span> 
        
        <span class="k">if</span> <span class="n">warrior_cnt</span> <span class="o">&gt;</span> <span class="n">max_cnt</span><span class="p">:</span>
            <span class="n">max_cnt</span> <span class="o">=</span> <span class="n">warrior_cnt</span> 
            <span class="n">return_vision_map</span> <span class="o">=</span> <span class="n">vision</span> 
            <span class="n">best_dir</span> <span class="o">=</span> <span class="n">t</span>


    <span class="k">return</span> <span class="n">max_cnt</span><span class="p">,</span> <span class="n">return_vision_map</span><span class="p">,</span> <span class="n">best_dir</span> 
        

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_mahattan_distance</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">reinit_visit</span><span class="p">(</span><span class="n">war_id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">visited</span> 
    <span class="k">while</span> <span class="n">visited</span><span class="p">[</span><span class="n">war_id</span><span class="p">]:</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">war_id</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">build_distances</span><span class="p">()</span> <span class="c1"># 끝점 (e_y, e_x)에서 시작점 까지의 최단 거리 disatnces_graph 채움 </span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">dijkstra</span><span class="p">()</span> <span class="c1"># path는 (s_y, s_x)에서 끝점 (e_y, e_x)까지 최단 거리로 가는 길 반환 </span>
    <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">path</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span> <span class="c1"># 맨 처음 위치 생략 </span>
        <span class="c1"># path에 들어있는 길만큼 턴이 진행됨. </span>
        <span class="k">while</span> <span class="n">path</span><span class="p">:</span>
            <span class="c1"># 살아있는 전사들은 모두 is_stoned에서 풀려남 </span>

            <span class="c1"># step1. 메두사의 이동 </span>
            <span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nxt_y</span> <span class="o">==</span> <span class="n">e_y</span> <span class="ow">and</span> <span class="n">nxt_x</span> <span class="o">==</span> <span class="n">e_x</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">break</span> <span class="c1"># 메두사가 공원에 도착하면, 0을 출력 후 종료 </span>
            
            <span class="n">medusa_object</span><span class="o">.</span><span class="n">set_loc</span><span class="p">(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)</span>
            <span class="c1"># 메두사가 이동한 후 위치에 전사들이 있으면 공격을 받고 사라짐. </span>
            <span class="n">warriors_ids</span> <span class="o">=</span> <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)]</span> 
            <span class="k">if</span> <span class="n">warriors_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">warriors_ids</span><span class="p">:</span>  
                    <span class="n">alive</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
                    
                <span class="c1"># 현재 위치는 다 동일하므로, 아래에 대해서는 한 번만 없애주면 됨.</span>
                <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">nxt_y</span><span class="p">,</span> <span class="n">nxt_x</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># 빈 집합으로 전사들 모두 정리 </span>
            
            <span class="c1"># step2. 메두사의 시선 </span>
            <span class="n">num_stoned_warriors</span><span class="p">,</span> <span class="n">vision_map</span><span class="p">,</span> <span class="n">best_dir</span> <span class="o">=</span> <span class="n">calculate_vision</span><span class="p">(</span><span class="n">medusa_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">medusa_object</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            
            <span class="c1"># step3. 전사들의 이동 </span>
            <span class="n">reached_warriors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">total_steps</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="c1"># 살아있는 전사들에 대해서</span>
            <span class="k">for</span> <span class="n">war_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">alive</span><span class="p">[</span><span class="n">war_id</span><span class="p">]:</span> <span class="c1"># 죽은 전사들 pass </span>
                    <span class="k">continue</span> 
    
                <span class="k">if</span> <span class="n">vision_map</span><span class="p">[</span><span class="n">war_ys</span><span class="p">[</span><span class="n">war_id</span><span class="p">]][</span><span class="n">war_xs</span><span class="p">[</span><span class="n">war_id</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 살아있지만, 메두사의 시야에 있는 전사들은 돌이됨. </span>
                    <span class="k">continue</span> <span class="c1"># 이번 턴은 돌이 돼서 움직일 수 없음. </span>
                
                <span class="n">move_cnt</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
                <span class="n">w_y</span> <span class="o">=</span> <span class="n">war_ys</span><span class="p">[</span><span class="n">war_id</span><span class="p">];</span> <span class="n">w_x</span> <span class="o">=</span> <span class="n">war_xs</span><span class="p">[</span><span class="n">war_id</span><span class="p">]</span>
                
                <span class="n">reinit_visit</span><span class="p">(</span><span class="n">war_id</span><span class="p">)</span> <span class="c1"># visited 관리, 메모리 사용량 줄이기 위해, 시작하기 전에 빈 리스트로 만들어줌. </span>
            
                <span class="n">cur_best_distance</span> <span class="o">=</span> <span class="n">calculate_mahattan_distance</span><span class="p">(</span><span class="n">w_y</span><span class="p">,</span> <span class="n">w_x</span><span class="p">,</span> <span class="n">medusa_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">medusa_object</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">w_y</span><span class="p">,</span> <span class="n">w_x</span><span class="p">,</span> <span class="n">cur_best_distance</span><span class="p">))</span>
                
                <span class="k">while</span> <span class="n">move_cnt</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_dis</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
                    <span class="c1"># distance_between_medusa = calculate_mahattan_distance(cur_y, cur_x, medusa_object.y, medusa_object.x)</span>
                    
                    <span class="k">if</span> <span class="n">cur_dis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 0 &lt;= move_cnt가 &lt;= 2일 때 warriors가 메두사의 위치와 동일하면,</span>
                        <span class="n">reached_warriors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">war_id</span><span class="p">)</span>
                        <span class="k">break</span> 

                    <span class="k">if</span> <span class="n">move_cnt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># </span>
                        <span class="k">break</span> 
                    <span class="c1"># if distance_between_medusa &gt;= cur_best_distance:  # 상하좌우로 우선순위 선택 </span>
                    <span class="c1">#     continue </span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">move_cnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">range_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">move_cnt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">range_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span> <span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">range_list</span><span class="p">:</span> <span class="c1"># 상하좌우로 우선순위 선택 </span>
                        <span class="c1"># print(f&quot;range_list: {range_list}&quot;)</span>
                        <span class="n">ny</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="o">%</span><span class="mi">4</span><span class="p">]</span> <span class="p">;</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="o">%</span><span class="mi">4</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> \
                        <span class="n">vision_map</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> \
                            <span class="ow">not</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">[</span><span class="n">war_id</span><span class="p">]:</span>
                            <span class="n">new_distance_between_medusa</span> <span class="o">=</span> <span class="n">calculate_mahattan_distance</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">medusa_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">medusa_object</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                            <span class="c1"># 한번 업데이트 하면 for loop break </span>
                            <span class="k">if</span> <span class="n">new_distance_between_medusa</span> <span class="o">&lt;</span> <span class="n">cur_dis</span><span class="p">:</span> <span class="c1"># 상하좌우로 우선순위 선택 </span>
                                <span class="n">move_cnt</span> <span class="o">+=</span> <span class="mi">1</span> 
                                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">new_distance_between_medusa</span><span class="p">))</span>
                                <span class="c1"># warrior.loc = (ny, nx) # update</span>
                                <span class="n">war_ys</span><span class="p">[</span><span class="n">war_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ny</span> 
                                <span class="n">war_xs</span><span class="p">[</span><span class="n">war_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span>  
                                <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span> 
                                <span class="n">visited</span><span class="p">[</span><span class="n">war_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
                                <span class="k">break</span> <span class="c1"># 찾으면 for loop 종료 </span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
                        <span class="k">break</span> <span class="c1"># 현재 자리에서 이동할 것이 없으면 나와야함. </span>
                     
                    
                <span class="c1"># XXX: </span>
                <span class="k">if</span> <span class="n">move_cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 움직였으면, 데이터 업데이트 </span>
                    <span class="c1"># 새로운 위치 업데이트 (더함)</span>
                    <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">war_ys</span><span class="p">[</span><span class="n">war_id</span><span class="p">],</span> <span class="n">war_xs</span><span class="p">[</span><span class="n">war_id</span><span class="p">])]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">war_id</span><span class="p">)</span>
                    <span class="c1"># 기존 위치 (w_y, w_x) 삭제</span>
                    <span class="c1"># XXX: 여기서 삭제하지 않으면 lazy deletion 필요 </span>
                    <span class="c1"># XXX: O(1)로 삭제할 수 있으면 가능. 근데, 현재 war_id가 warriors_graph[(y, x)] 의 list 어디에 존재하는지 알아야 O(1)으로 삭제 가능 </span>
                    <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">w_y</span><span class="p">,</span> <span class="n">w_x</span><span class="p">)]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">war_id</span><span class="p">)</span>

                <span class="n">total_steps</span> <span class="o">+=</span> <span class="n">move_cnt</span> 


            <span class="c1"># step4.: 메두사와 같은 칸에 도달한 전사들은 공격 후 사라짐. </span>
            <span class="n">num_removed_war</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reached_warriors</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">removed_war_id</span> <span class="ow">in</span> <span class="n">reached_warriors</span><span class="p">:</span>
                <span class="n">alive</span><span class="p">[</span><span class="n">removed_war_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
                <span class="n">warriors_graph</span><span class="p">[(</span><span class="n">war_ys</span><span class="p">[</span><span class="n">removed_war_id</span><span class="p">],</span> <span class="n">war_xs</span><span class="p">[</span><span class="n">removed_war_id</span><span class="p">])]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">removed_war_id</span><span class="p">)</span>

            
            <span class="c1"># print(total_steps, total_stoned_warriors, num_removed_war)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">total_steps</span><span class="p">,</span> <span class="n">num_stoned_warriors</span><span class="p">,</span> <span class="n">num_removed_war</span><span class="p">)</span>
            
            <span class="c1"># 살아있는 전사가 없으면 while 문을 break하고 0 0 0 혹은 0을 남은 횟수까지 출력함. </span>
            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">alive</span><span class="p">[</span><span class="n">war_id</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">war_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span> <span class="c1"># while break </span>
        
        <span class="c1"># path가 남아있으면 </span>
        <span class="k">while</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ny</span> <span class="o">==</span> <span class="n">e_y</span> <span class="ow">and</span> <span class="n">nx</span> <span class="o">==</span> <span class="n">e_x</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 메두사의 집으로부터 공원까지 도달하는 경로가 없는 경우 -1 출력 후 프로그램 종료 </span>


</pre></div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">test case</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Test case: 

7 4
1 1 5 0
5 3 4 5 6 3 3 1
0 0 0 0 0 1 0
0 0 0 1 0 1 0
0 1 1 0 0 0 0
1 0 0 0 0 0 0
0 0 1 0 0 0 0
0 0 0 0 0 1 0
0 0 0 0 1 0 0

Answer: 
0 3 0
0 3 0
0 3 0
0 3 0
2 2 0
2 2 1
0 2 0
1 1 1
0 2 0
0 1 0
0 1 0
0 1 0
0
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Test case: 
5 9
2 1 1 2
0 2 1 4 0 1 4 3 2 4 4 0 3 2 4 4 2 3
1 0 0 0 1
0 0 0 0 1
0 0 1 0 0
0 0 1 0 1
0 0 0 0 0

Answer: 
7 4 1
0
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Test case:
5 10
2 4 4 4
0 3 3 2 2 1 3 3 0 4 2 2 1 2 1 0 2 0 2 3
0 0 0 0 0
0 0 1 1 1
0 0 0 0 0
0 0 0 0 0
1 1 1 1 0

Answer:
14 2 2
0
</pre></div>
</div>
</div>
</section>
<section id="id11">
<h3>미지의 공간 탈출<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p><a class="reference download internal" download="" href="../../_downloads/63c817e5c1b8c0f5ea73ae1e475579c1/5.py"><span class="xref download myst">sol3</span></a></p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-number">예시 42 </span><span class="caption-text">미지의 공간 탈출 Solution Code</span><a class="headerlink" href="#id16" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 

<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span> 
<span class="c1"># sys.stdin = open(&quot;Input.txt&quot;)</span>
<span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">F</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">필요한 데이터 구조</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">MAX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># 시간의 벽면도 </span>
<span class="n">wall_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)]</span> <span class="c1"># 5 (없는 공간) 장애물로 초기화 </span>
<span class="n">distance_wall_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MAX</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)]</span>
<span class="n">distance_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MAX</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">weird_time_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">weird_time_wall_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)]</span>
<span class="n">f_v_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">f_d_list</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">f_y_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">f_x_list</span><span class="o">=</span> <span class="p">[]</span> 
<span class="n">is_f_id_in_wall</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="n">F</span> 
<span class="n">has_diffusion_stopped</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="n">F</span> 
<span class="n">howmany_time_diffused</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">F</span> 
<span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> <span class="c1"># 시간의 벽 윗면에서 시작 위치 </span>
<span class="n">e_y_first</span><span class="p">,</span> <span class="n">e_x_first</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> <span class="c1"># 시간의 벽에서 도착 위치 </span>
<span class="n">s_y_second</span><span class="p">,</span> <span class="n">s_x_second</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> <span class="c1"># 단면도에서 시작 위치 </span>
<span class="n">e_y_final</span><span class="p">,</span> <span class="n">e_x_final</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> <span class="c1"># 단면도 최종 도착 위치 </span>
<span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># 첫번째 도착지점이 여기에 있음 </span>
<span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[:])</span>
    
    <span class="c1"># 두번째 시작 지점 찾기 </span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">upper_left_most_y</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span> 
                <span class="n">upper_left_most_x</span> <span class="o">=</span> <span class="n">idx</span> 
                <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 한번찾으면 안찾아도 됨. </span>
                <span class="k">break</span> 

    <span class="c1"># 두번째 도착지점 찾기 </span>
    <span class="k">if</span> <span class="n">flag2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">e_y_final</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span> 
                <span class="n">e_x_final</span> <span class="o">=</span> <span class="n">idx</span> 
                <span class="n">flag2</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 한번찾으면 안찾아도 됨. </span>
                <span class="k">break</span> 


<span class="c1"># 처음 3을 찾고, MxM에서 옆에 0이 있는 그지점이 단면도까지의 도착 위치 </span>
<span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># print(f&quot;upper y, x{upper_left_most_y, upper_left_most_x}&quot;)</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">upper_left_most_y</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">upper_left_most_y</span><span class="o">+</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">upper_left_most_x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">upper_left_most_x</span><span class="o">+</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s_y_second</span> <span class="o">=</span> <span class="n">y</span>  
            <span class="n">s_x_second</span> <span class="o">=</span> <span class="n">x</span> 
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span> 
            <span class="k">break</span> 
    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
        <span class="k">break</span> 

<span class="c1"># 단면도상 (N) 에서의 첫번째 도착위치 -&gt; 시간의 벽 상(3*M) 에서의 도착 위치 </span>
<span class="k">def</span><span class="w"> </span><span class="nf">transform_second_start_to_first_end</span><span class="p">(</span><span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span><span class="p">):</span>
    <span class="c1"># global s_y_second, cur_x, e_y_first, e_x_first </span>

    <span class="c1"># # 단면도에서 의 최외곽 </span>
    <span class="c1"># outer_list = []</span>
    <span class="c1"># for i in range(M): # 맨 윗줄 </span>
    <span class="c1">#     outer_list.append((upper_left_most_y-1, upper_left_most_x+i))</span>
    <span class="c1"># for i in range(M): # 맨 아랫줄 </span>
    <span class="c1">#     outer_list.append((upper_left_most_y+M, upper_left_most_x+i))</span>
    <span class="c1"># for i in range(M): # 맨 왼쪽 줄 </span>
    <span class="c1">#     outer_list.append((upper_left_most_y+i, upper_left_most_x-1))</span>
    <span class="c1"># for i in range(M): # 맨 오른쪽 </span>
    <span class="c1">#     outer_list.append((upper_left_most_y+i, upper_left_most_x+M))</span>

    <span class="c1"># print(f&quot;outer_list: {outer_list}&quot;) # 4*M 의 length </span>

    <span class="n">returny</span><span class="p">,</span> <span class="n">returnx</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> 
    <span class="c1"># 위 </span>
    <span class="k">if</span> <span class="n">cur_y</span> <span class="o">==</span> <span class="n">upper_left_most_y</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">upper_left_most_x</span> <span class="o">&lt;=</span> <span class="n">cur_x</span> <span class="o">&lt;</span> <span class="n">upper_left_most_x</span> <span class="o">+</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">returny</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">-</span> <span class="n">upper_left_most_x</span>
        <span class="n">returnx</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="n">diff</span> 
    <span class="c1"># 아래 </span>
    <span class="k">elif</span> <span class="n">cur_y</span> <span class="o">==</span> <span class="n">upper_left_most_y</span> <span class="o">+</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">upper_left_most_x</span><span class="o">&lt;=</span><span class="n">cur_x</span> <span class="o">&lt;</span> <span class="n">upper_left_most_x</span> <span class="o">+</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">returny</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span><span class="mi">1</span> 
        <span class="n">diff</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">-</span> <span class="n">upper_left_most_x</span>
        <span class="n">returnx</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="n">diff</span> 
    <span class="c1"># 왼쪽 </span>
    <span class="k">elif</span> <span class="n">upper_left_most_y</span> <span class="o">&lt;=</span> <span class="n">cur_y</span> <span class="o">&lt;</span> <span class="n">upper_left_most_y</span> <span class="o">+</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">cur_x</span> <span class="o">==</span> <span class="n">upper_left_most_x</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">-</span> <span class="n">upper_left_most_y</span>
        <span class="n">returny</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="n">diff</span> 
        <span class="n">returnx</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="c1"># 오른쪽 </span>
    <span class="k">elif</span> <span class="n">upper_left_most_y</span> <span class="o">&lt;=</span> <span class="n">cur_y</span> <span class="o">&lt;</span> <span class="n">upper_left_most_y</span> <span class="o">+</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">cur_x</span> <span class="o">==</span> <span class="n">upper_left_most_x</span> <span class="o">+</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">-</span> <span class="n">upper_left_most_y</span>
        <span class="n">returny</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="n">diff</span> 
        <span class="n">returnx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span><span class="mi">1</span> 

    <span class="k">return</span> <span class="n">returny</span><span class="p">,</span> <span class="n">returnx</span>
 

    
<span class="n">e_y_first</span><span class="p">,</span> <span class="n">e_x_first</span> <span class="o">=</span> <span class="n">transform_second_start_to_first_end</span><span class="p">(</span><span class="n">s_y_second</span><span class="p">,</span> <span class="n">s_x_second</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">rotation_90CCW</span><span class="p">(</span><span class="n">original_graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    (y, x) -&gt; (M-x-1, y)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">new_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">new_graph</span><span class="p">[</span><span class="n">M</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">original_graph</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_graph</span><span class="p">[</span><span class="n">idx</span><span class="p">][:]</span> <span class="c1"># update </span>

<span class="n">new_graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="c1"># 동서남북윗면 평면도 순 </span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 동쪽이면, 왼쪽으로 90도 회전 </span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="c1"># wall_graph[M+i][2*M:] = list(map(int, input().split()))</span>
            <span class="n">new_graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="n">rotation_90CCW</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">wall_graph</span><span class="p">[</span><span class="n">M</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">:]</span> <span class="o">=</span> <span class="n">new_graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 서쪽이면, 왼쪽으로 270도 회전 </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="c1"># wall_graph[M+i][:M] = list(map(int, input().split()))</span>
            <span class="n">new_graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="n">rotation_90CCW</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>
        <span class="n">rotation_90CCW</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>
        <span class="n">rotation_90CCW</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">wall_graph</span><span class="p">[</span><span class="n">M</span><span class="o">+</span><span class="n">i</span><span class="p">][:</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># 남쪽 그대로 </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">wall_graph</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">M</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>

    <span class="k">elif</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># 북쪽이면, 왼쪽으로 180도 회전 </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="c1"># wall_graph[i][M:2*M] = list(map(int, input().split()))</span>
            <span class="n">new_graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>

        <span class="n">rotation_90CCW</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>
        <span class="n">rotation_90CCW</span><span class="p">(</span><span class="n">new_graph</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">wall_graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">M</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


    <span class="k">elif</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span> <span class="c1"># 윗면 </span>
        <span class="c1"># 이 윗면에 시작점이 존재함. </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">wall_graph</span><span class="p">[</span><span class="n">M</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">M</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">wall_graph</span><span class="p">[</span><span class="n">M</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">s_y</span> <span class="o">=</span> <span class="n">M</span><span class="o">+</span><span class="n">i</span> 
                    <span class="n">s_x</span> <span class="o">=</span> <span class="n">x</span> 


<span class="c1"># 각 Cell마다 dy, dx 설정</span>
<span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># 동서남북  0/1/2/3</span>
<span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_next_cell</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    특정 셀이 아니면 (-1, -1)를 반환 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># 좌측상단 설정 </span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">nxtx</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">elif</span> <span class="mi">0</span><span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">nxtx</span> <span class="o">=</span> <span class="n">y</span>
    <span class="c1"># 우측상단설정 </span>
    <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span> 
        <span class="n">nxtx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="n">M</span> <span class="ow">and</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">nxtx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span>
    <span class="c1"># 우측하단 설정 </span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="n">x</span> 
        <span class="n">nxtx</span> <span class="o">=</span> <span class="n">y</span> 
    <span class="k">elif</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="n">x</span> 
        <span class="n">nxtx</span> <span class="o">=</span> <span class="n">y</span> 
    <span class="c1"># 좌측하단 설정 </span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span><span class="mi">1</span> 
        <span class="n">nxtx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span><span class="mi">1</span> 
    <span class="k">elif</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="ow">and</span>  <span class="n">x</span> <span class="o">==</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">nxtx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span><span class="mi">1</span> 
    <span class="k">else</span><span class="p">:</span> <span class="c1"># 그외의 공간은 방향이 없음 </span>
        <span class="n">nxty</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 
        <span class="n">nxtx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 
    <span class="k">return</span> <span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span> 


<span class="c1"># print(find_next_cell(0, 3)) # (3,0)</span>
<span class="c1"># print(find_next_cell(1, 3)) # (3,1)</span>
<span class="c1"># print(find_next_cell(0, 5)) # (3, 8)</span>
<span class="c1"># print(find_next_cell(1, 5)) # (3, 7)</span>
<span class="c1"># print(find_next_cell(3, 0)) # (0, 3)</span>
<span class="c1"># print(find_next_cell(5, 6)) # (6, 5)</span>
<span class="c1"># print(find_next_cell(5, 8)) # (8, 5)</span>
<span class="c1"># print(find_next_cell(5, 0)) # (8, 3)</span>
<span class="c1"># print(find_next_cell(5, 1)) # (7, 3)</span>
<span class="c1"># print(find_next_cell(0, 0)) # (-1, -1)</span>
<span class="c1"># print(find_next_cell(3, 3)) # (-1, -1)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">wall_in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">M</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span>

<span class="k">def</span><span class="w"> </span><span class="nf">graph_in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">N</span> 
    <span class="k">return</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;</span><span class="n">N</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">N</span> 

<span class="k">for</span> <span class="n">f_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>  
    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">time_d</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="c1"># 미지의 바닥 공간에만 존재. </span>
    <span class="n">weird_time_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_id</span> 
    <span class="n">f_v_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
    <span class="n">f_d_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_d</span><span class="p">)</span>
    <span class="n">f_y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">f_x_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># 단면도 -&gt; wall안에서 확산하는 과정을 list에 저장  </span>
<span class="c1"># idx로 돌면서, 해당 시간이 지나면, 그 idx에 있도록 하기 </span>
<span class="k">def</span><span class="w"> </span><span class="nf">diffusion_f</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">F</span><span class="p">,</span> <span class="n">f_v_list</span>

    <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 확산 필요 없음 </span>
        <span class="k">return</span> 

    <span class="k">for</span> <span class="n">f_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">has_diffusion_stopped</span><span class="p">[</span><span class="n">f_id</span><span class="p">]:</span>
            <span class="k">continue</span> 

        <span class="c1"># XXX: 0으로 나눌때마다 diffusion하면 안됨 </span>
        <span class="c1"># BFS에서는 같은 시간 curtime 이 7번이 여러번 나올수도 있음. </span>
        <span class="c1"># 현재 시간 5//5 == 1 이면, 기존 diffusion 횟수가 0번이여야 diffusion 가능 </span>
        <span class="k">if</span> <span class="n">time</span> <span class="o">%</span> <span class="n">f_v_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">time</span> <span class="o">//</span> <span class="n">f_v_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">==</span> <span class="n">howmany_time_diffused</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_f_id_in_wall</span><span class="p">[</span><span class="n">f_id</span><span class="p">]:</span> <span class="c1"># 단면도에서 확산 </span>
                <span class="c1"># 확산해야함. 확산 방향 1개 </span>
                <span class="n">f_dir</span> <span class="o">=</span> <span class="n">f_d_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="c1"># 0/1/2/3 동서남북 </span>
                <span class="n">f_y</span> <span class="o">=</span> <span class="n">f_y_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span>
                <span class="n">f_x</span> <span class="o">=</span> <span class="n">f_x_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span>
                <span class="n">nxty</span> <span class="o">=</span> <span class="n">f_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">f_dir</span><span class="p">]</span> <span class="p">;</span> <span class="n">nxtx</span> <span class="o">=</span> <span class="n">f_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">f_dir</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">graph_in_range</span><span class="p">(</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">):</span> <span class="c1"># 범위밖 </span>
                    <span class="n">has_diffusion_stopped</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                    <span class="k">continue</span> 
                <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">has_diffusion_stopped</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                    <span class="k">continue</span> <span class="c1"># 장애물과 탈출구가 있으면 움직일 수 없음. </span>
                    
                <span class="c1"># 확산 가능 </span>
                <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># 다음 방향이 벽면임 </span>
                    <span class="c1"># ㅋㅋㅋㅋㅋ </span>
                    <span class="n">is_f_id_in_wall</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                    <span class="c1"># 현재 단면도 -&gt; 시간의 벽 상의 포지션으로 바꿈 </span>
                    <span class="n">wally</span><span class="p">,</span> <span class="n">wallx</span> <span class="o">=</span> <span class="n">transform_second_start_to_first_end</span><span class="p">(</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">wall_graph</span><span class="p">[</span><span class="n">wally</span><span class="p">][</span><span class="n">wallx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 그래프상 1이면 </span>
                        <span class="n">has_diffusion_stopped</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                        <span class="k">continue</span> <span class="c1"># 확산 stop </span>
                    <span class="k">else</span><span class="p">:</span> <span class="c1"># 그래프에 0이나 2면, 확산 가능 </span>
                        <span class="n">weird_time_wall_graph</span><span class="p">[</span><span class="n">wally</span><span class="p">][</span><span class="n">wallx</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_id</span> 
                        <span class="n">f_y_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">wally</span> 
                        <span class="n">f_x_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">wallx</span> 
                        <span class="n">howmany_time_diffused</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 

                <span class="k">elif</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">weird_time_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_id</span> <span class="c1"># 확산 </span>
                    <span class="n">f_y_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nxty</span> 
                    <span class="n">f_x_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nxtx</span> 
                    <span class="n">howmany_time_diffused</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 

            <span class="k">else</span><span class="p">:</span> <span class="c1"># 시간의 벽에서 확산 </span>
                <span class="c1"># 확산해야함. 확산 방향 1개 </span>
                <span class="n">f_dir</span> <span class="o">=</span> <span class="n">f_d_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="c1"># 0/1/2/3 동서남북 </span>
                <span class="n">f_y</span> <span class="o">=</span> <span class="n">f_y_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span>
                <span class="n">f_x</span> <span class="o">=</span> <span class="n">f_x_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span>
                <span class="n">nxty</span> <span class="o">=</span> <span class="n">f_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">f_dir</span><span class="p">]</span> <span class="p">;</span> <span class="n">nxtx</span> <span class="o">=</span> <span class="n">f_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">f_dir</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">wall_in_range</span><span class="p">(</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">):</span> <span class="c1"># 범위밖 </span>
                    <span class="n">has_diffusion_stopped</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                    <span class="k">continue</span> 
                <span class="k">if</span> <span class="n">wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">has_diffusion_stopped</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
                    <span class="k">continue</span> <span class="c1"># 장애물이있으면 움직일 수 없음. </span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weird_time_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span><span class="o">=</span> <span class="n">f_id</span> 
                    <span class="n">f_y_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nxty</span> 
                    <span class="n">f_x_list</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nxtx</span> 
                    <span class="n">howmany_time_diffused</span><span class="p">[</span><span class="n">f_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 

            

<span class="k">def</span><span class="w"> </span><span class="nf">debug</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">wall_graph</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start point: </span><span class="si">{</span><span class="n">s_y</span><span class="p">,</span><span class="w"> </span><span class="n">s_x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First End point on time wall: </span><span class="si">{</span><span class="n">e_y_first</span><span class="p">,</span><span class="w"> </span><span class="n">e_x_first</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Second Start point: </span><span class="si">{</span><span class="n">s_y_second</span><span class="p">,</span><span class="w"> </span><span class="n">s_x_second</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Second End point: </span><span class="si">{</span><span class="n">e_y_final</span><span class="p">,</span><span class="w"> </span><span class="n">e_x_final</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;first total time: </span><span class="si">{</span><span class="n">first_total_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total_time : </span><span class="si">{</span><span class="n">total_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Step1: 시간의 벽에서 미지의 공간의 바닥의 출구로 경로 탐색 </span>
    <span class="n">total_time</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s_y</span><span class="p">,</span> <span class="n">s_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1"># 타임머신 위치, 현재 시간 </span>
    <span class="n">distance_wall_graph</span><span class="p">[</span><span class="n">s_y</span><span class="p">][</span><span class="n">s_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># 3*M x 3xM에서 여행 </span>
    
    <span class="n">find_first_path</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">cury</span><span class="p">,</span> <span class="n">curx</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">cury</span> <span class="o">==</span> <span class="n">e_y_first</span> <span class="ow">and</span> <span class="n">curx</span> <span class="o">==</span> <span class="n">e_x_first</span><span class="p">:</span>
            <span class="n">find_first_path</span> <span class="o">=</span> <span class="mi">1</span> 
            <span class="n">total_time</span> <span class="o">=</span> <span class="n">curtime</span> 
            <span class="k">break</span> 

        <span class="c1"># sumF = sum(1 if has_diffusion_stopped[f_id] else 0 for f_id in range(F))</span>
        <span class="c1"># if sumF == F and </span>
        <span class="c1"># 시간이상현상 확산 </span>
        <span class="c1"># 만약 현재 시간이 v_i의 배수이면, 타임머신이 이동해있음 </span>
        <span class="n">diffusion_f</span><span class="p">(</span><span class="n">curtime</span><span class="p">)</span>

        <span class="c1"># 만약 현재 시간에 시간의 벽에 출구를 통해 시간 이상 현상이 확산되면, 길이 없음 </span>
        <span class="k">if</span> <span class="n">weird_time_wall_graph</span><span class="p">[</span><span class="n">e_y_first</span><span class="p">][</span><span class="n">e_x_first</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># print(-1)</span>
            <span class="k">break</span> 

        <span class="c1"># 타임머신 이동 </span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># 동서남북 </span>
            <span class="n">nxty</span> <span class="o">=</span> <span class="n">cury</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">nxtx</span> <span class="o">=</span> <span class="n">curx</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">wall_in_range</span><span class="p">(</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">):</span> <span class="c1"># 격자 밖인 경우 </span>
                <span class="k">continue</span> 

            <span class="k">if</span> <span class="n">wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> <span class="c1"># 장애물이 있는 경우 </span>
                <span class="k">continue</span> 
            
            <span class="k">if</span> <span class="n">wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">:</span> <span class="c1"># 원래 범위가 아닌 경우 </span>
                <span class="k">continue</span> 

            <span class="k">if</span> <span class="n">weird_time_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># 시간 이상 현상 존재 </span>
                <span class="k">continue</span> 
            <span class="c1"># 위의 경우가 아니면 이동 가능 </span>
            <span class="k">if</span> <span class="n">distance_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="n">MAX</span><span class="p">:</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">distance_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">=</span> <span class="n">curtime</span> <span class="o">+</span> <span class="mi">1</span> 
                <span class="c1"># wall_graph[nxty][nxtx] = 2 ### DEBUG </span>

        <span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span> <span class="o">=</span> <span class="n">find_next_cell</span><span class="p">(</span><span class="n">cury</span><span class="p">,</span> <span class="n">curx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nxty</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">nxtx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span> <span class="c1"># 벽면을 타고 움직일 수 없음 </span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span> <span class="c1"># 장애물이 있음 </span>
            <span class="k">if</span> <span class="n">weird_time_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># 시간이상현상 존재 </span>
                <span class="k">continue</span> 
            <span class="c1"># 위의 경우가 아니면 이동 가능 </span>
            <span class="k">if</span> <span class="n">distance_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="n">MAX</span><span class="p">:</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">+</span><span class="mi">1</span> <span class="p">))</span>
                <span class="n">distance_wall_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">=</span> <span class="n">curtime</span> <span class="o">+</span> <span class="mi">1</span> 
                <span class="c1"># weird_time_wall_graph[nxty][nxtx] = 2 </span>
                <span class="c1"># wall_graph[nxty][nxtx]= 2 </span>

    <span class="k">if</span> <span class="n">find_first_path</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># 시간의 벽에서 탈출 성공 </span>
        <span class="c1"># print(total_time)</span>
        <span class="n">first_total_time</span> <span class="o">=</span> <span class="n">total_time</span> 
        <span class="c1"># 첫번째 도착지점에서 -&gt; 두번째 도착지점까지 1시간 걸림 </span>
        <span class="n">total_time</span> <span class="o">+=</span> <span class="mi">1</span> 
        <span class="c1"># 바닥에서 탈출하기 </span>

        <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
        <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s_y_second</span><span class="p">,</span> <span class="n">s_x_second</span><span class="p">,</span> <span class="n">total_time</span><span class="p">))</span>
        <span class="n">distance_graph</span><span class="p">[</span><span class="n">s_y_second</span><span class="p">][</span><span class="n">s_x_second</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">find_second_path</span> <span class="o">=</span> <span class="mi">0</span> 

        <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
            <span class="n">cury</span><span class="p">,</span> <span class="n">curx</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

            <span class="c1"># 현재 시간, 현재 위치에 이상 현상 있으면 제거 </span>
            <span class="k">if</span> <span class="n">weird_time_graph</span><span class="p">[</span><span class="n">cury</span><span class="p">][</span><span class="n">curx</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span> 
            <span class="c1"># if cury == e_y_final and curx == e_x_final:</span>
            <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">cury</span><span class="p">][</span><span class="n">curx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span> <span class="c1"># 도착지점 </span>
                <span class="nb">print</span><span class="p">(</span><span class="n">curtime</span><span class="p">)</span>
                <span class="n">total_time</span> <span class="o">=</span> <span class="n">curtime</span> 
                <span class="n">find_second_path</span> <span class="o">=</span> <span class="mi">1</span> 
                <span class="k">break</span> 
            
            <span class="n">diffusion_f</span><span class="p">(</span><span class="n">curtime</span><span class="p">)</span>

            <span class="c1"># 타임머신 이동 </span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># 동서남북 </span>
                <span class="n">nxty</span> <span class="o">=</span> <span class="n">cury</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                <span class="n">nxtx</span> <span class="o">=</span> <span class="n">curx</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">graph_in_range</span><span class="p">(</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">):</span> <span class="c1"># 격자 밖인 경우 </span>
                    <span class="k">continue</span> 

                <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 장애물이 있는 경우 </span>
                    <span class="k">continue</span> 

                <span class="k">if</span> <span class="n">graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># 다시 시간의 벽으로 들어감 </span>
                    <span class="k">continue</span> 

                <span class="k">if</span> <span class="n">weird_time_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># 시간 이상 현상 존재 </span>
                    <span class="k">continue</span> 

                <span class="c1"># 위의 경우가 아니면 이동 가능 </span>
                <span class="k">if</span> <span class="n">distance_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">==</span> <span class="n">MAX</span><span class="p">:</span>
                    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxty</span><span class="p">,</span> <span class="n">nxtx</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">distance_graph</span><span class="p">[</span><span class="n">nxty</span><span class="p">][</span><span class="n">nxtx</span><span class="p">]</span> <span class="o">=</span> <span class="n">curtime</span> <span class="o">+</span> <span class="mi">1</span> 
                    <span class="c1"># wall_graph[nxty][nxtx] = 2 ### DEBUG </span>

        <span class="k">if</span> <span class="n">find_first_path</span> <span class="ow">and</span> <span class="n">find_second_path</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                
    <span class="c1"># debug()   </span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">test case</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Test case: 
10 2 2
0 0 0 0 1 0 0 0 0 0
1 0 0 0 0 1 0 0 1 1
0 0 0 0 1 0 1 0 0 1
0 0 0 0 0 1 1 1 1 0
0 0 4 1 0 1 3 3 1 1
0 0 0 1 1 1 3 3 1 1
0 0 0 0 1 1 0 1 1 0
0 0 0 0 0 0 0 0 1 1
0 0 1 0 0 0 0 1 1 0
0 0 0 1 0 0 1 0 1 1
1 1
1 1
1 1
1 1
0 1
0 1
1 0
1 1
0 1
2 0
9 1 2 11
8 4 3 15

Answer:
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Test case: 
13 5 3
1 0 0 0 0 0 0 0 0 0 0 0 1
0 0 0 0 0 0 0 0 0 1 0 1 0
0 0 0 0 1 0 0 0 0 0 0 0 1
0 1 0 0 1 0 0 0 0 0 0 0 1
4 0 0 0 0 0 0 0 0 0 0 0 1
0 0 0 1 1 1 1 0 1 1 1 0 1
0 0 0 1 1 3 3 3 3 3 1 1 0
0 0 1 0 1 3 3 3 3 3 1 0 0
1 0 0 0 1 3 3 3 3 3 1 1 0
1 0 0 1 1 3 3 3 3 3 1 0 0
0 0 0 1 1 3 3 3 3 3 1 0 1
0 0 0 0 1 1 1 1 1 1 1 0 0
0 0 0 1 0 1 1 0 1 0 1 0 1
1 1 1 1 1
1 0 0 0 0
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
0 0 1 1 1
0 1 1 1 1
0 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
0 0 0 0 0
0 0 0 0 0
0 0 0 0 1
0 0 0 1 1
1 1 0 1 1
0 0 0 0 0
0 0 0 0 0
1 1 1 1 2
1 1 1 1 0
1 1 1 1 0
7 1 3 12
2 2 0 24
0 8 0 20
</pre></div>
</div>
</div>
</section>
<section id="id12">
<h3>마법의 숲 탐색<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">문제 정리</p>
<ol class="arabic">
<li><p>격좌/좌표: RxC를 HXC로 변환 (O, R-1) -&gt; (0, H-1)까지</p></li>
<li><p>move_golem(): 아래로 최대한 내려갈 수 있는 (move as far south as possible) 함수 구현</p>
<ol class="arabic simple">
<li><p>Step 2-1: rolling downward -&gt; collision check 3 cells</p></li>
<li><p>Step 2-2: rotating left while moving downward -&gt; collision check 5 cells</p></li>
<li><p>Step 2-3: rotating right while moving downward -&gt; collision check 5 cells</p></li>
</ol>
</li>
<li><p>settle_or_reset():</p>
<ol class="arabic simple">
<li><p>정착 실패: 골렘이 멈췄을 때 십자 5칸 중 한 칸이라도 숲 밖(상단 패딩 포함 관점)이라면, 지금까지 놓인 모든 골렘을 전부 지우고 이번 시도는 0점 처리 후 다음 시도로 넘어간다.</p></li>
<li><p>정착 성공 시 배치: 정지 위치에 중심+팔 4칸을 기록하고, 출구 방향도 함께 저장한다(다음 단계 탐색에 필요).</p></li>
</ol>
</li>
<li><p>spirits 탐색 (explore)</p>
<ol class="arabic simple">
<li><p>골렘의 출구와 가까운 골렘을 통해 seed max값을 초기화 -&gt; 8가지 가능한 방향으로 같은 component의 값들에 큰 값 -&gt; 작은 값으로 value propagation(BFS사용)</p></li>
<li><p>관련하여 <a class="reference external" href="https://colab.research.google.com/github/Daye-Lee18/mybook/blob/main/assets/ipynb/propagation_demo.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> 시드의 최대값 초기화가 중요한 이유 확인</p></li>
</ol>
</li>
<li><p>solve(): 위의 함수들을 사용하여, input을 받고 결과 출력하는 함수</p>
<ol class="arabic simple">
<li><p>격자/좌표:</p></li>
</ol>
<ul class="simple">
<li><p>숲은 R×C 격자. 문제 기준으로 가장 위가 1행, 가장 아래가 R행(좌표는 1-based). 정령(골렘)은 북쪽(격자 위쪽) 바깥에서 진입한다.</p>
<ul>
<li><p>(구현 팁) 진입·회전 동작을 편하게 처리하려고 상단에 3행을 더 붙인 격자(R+3×C) 로 두고 시뮬레이션하는 전형적인 방식이 많이 쓰인다.</p></li>
</ul>
</li>
<li><p>입력 &amp; 골렘 정의 (총 K번)</p>
<ul>
<li><p>한 번의 시도마다 열 c(1…C), 출구 방향 d(0:북, 1:동, 2:남, 3:서) 가 주어진다. 골렘은 십자(+) 모양(중심+상하좌우) 으로 5칸을 차지하며, 출구는 중심에서 d 방향으로 인접한 1칸이다.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<div class="dropdown admonition">
<p class="admonition-title">graph의 확장</p>
<p><img alt="3-1" src="../../_images/11.png" /></p>
<p>In the beginning, the golem may extend up to <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">cells</span></code> above the forest. To handle this, we add 3 buffer rows at the top of the grid. These buffer rows are not part of the forest but provide enough room for the golem to move and settle safely.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">max value of each id</p>
<p>graph를 확장했으므로 (H= R + 3), best는 현재 골렘의 center_y, center_x보다 한 칸 아래인 것 ((cy +1, cx)이 맞으나,
확장된 그래프 전의 index를 사용해야하므로 (cy + 1 -3, cx)이다. 하지만, 1열을 0이 아닌 1로 표시하므로 (cy + 1 -3 +1, cx)로 결국 (cy -1, cx)가 된다.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">각 step 구현</p>
<p>When the golem moves one step down, we must check 3 positions below the center: directly underneath, and one cell to the left and right. If all 3 are empty, the golem can move downward without collision.
<img alt="3-2" src="../../_images/21.png" /></p>
<p>Now let’s look at rotation to the left. For the golem to rotate, <code class="docutils literal notranslate"><span class="pre">five</span> <span class="pre">specific</span> <span class="pre">cells</span></code> must be empty. Interestingly, the rules allow rotation even if the upper-right or lower-right cells are occupied. We number the directions North, East, South, and West as 0, 1, 2, and 3. Using this, left rotation is simply (d + 3) mod 4, and right rotation is (d + 1) mod 4.</p>
<p><img alt="3-3" src="../../_images/31.png" /></p>
<p>Rotation to the right works symmetrically. Again, five surrounding cells must be empty to allow the move. The concept is the same as left rotation, but we apply the clockwise formula.
<img alt="3-4" src="../../_images/41.png" /></p>
<p>When the golem finally stops, all four arms must be inside the forest area, which is from row 3 down to H–1. To manage state, we store each golem’s position and exit direction in units[gid]. We also record which exit belongs to which golem in exit_map. This way, exit_map tells us the gid, and units gives us the exact center and direction.
<img alt="3-5" src="../../_images/51.png" /></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">정보 저장</p>
<p>We maintain two separate grids: <code class="docutils literal notranslate"><span class="pre">golem_arr</span></code> and <code class="docutils literal notranslate"><span class="pre">exit_map</span></code>. The <code class="docutils literal notranslate"><span class="pre">golem</span> <span class="pre">array</span></code> records body occupancy and is used for <code class="docutils literal notranslate"><span class="pre">collision</span> <span class="pre">checks</span></code>. The <code class="docutils literal notranslate"><span class="pre">exit</span> <span class="pre">map</span></code> records <code class="docutils literal notranslate"><span class="pre">only</span> <span class="pre">exits</span></code>, which lets us trace connectivity between golems using <code class="docutils literal notranslate"><span class="pre">BFS</span></code>. This separation is crucial because body cells and exit cells need to be treated differently.</p>
<p><img alt="3-6" src="../../_images/6.png" /></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">최댓값 전파 BFS</p>
<p>현재 골렘의 최댓값을 전파하려면, “다른 골렘의 ‘출구‘“와 맞닿아있어야함. 따라서, 현재 골렘 8방에 다른 골렘의 출구가 있는지 출구 일때에만 전파를 해주는 것을 명심!</p>
<p><img alt="3-7" src="../../_images/7.png" /></p>
<p>Finally, let’s look at how we propagate the maximum reachable row.</p>
<ul class="simple">
<li><p>Step one: if <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">current</span> <span class="pre">golem’s</span> <span class="pre">exit</span></code> touches a neighbor’s body, we inherit its <code class="docutils literal notranslate"><span class="pre">max_row</span></code> as the <code class="docutils literal notranslate"><span class="pre">seed</span></code> value.</p></li>
<li><p>Step two: using BFS, we spread values along exit-to-exit connections across the whole component.</p></li>
</ul>
<p>This two-step design ensures accuracy — newly placed golems immediately get the correct value. It also improves efficiency, since we avoid repeated updates by maximizing early and propagating just once.</p>
<p><img alt="3-8" src="../../_images/8.png" /></p>
<ol class="arabic simple">
<li><p>best 계산 단계 (시드 확정)</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start_id</span></code> 의 출구 주변을 보면서, 이미 숲에 있던 이웃 골렘들이 가지고 있던 <code class="docutils literal notranslate"><span class="pre">max_row</span></code>값 참고</p></li>
<li><p>방금 들어온 골렘이 가질 수 있는 가장 큰 시작값 (best)를 정함.</p></li>
</ol>
</li>
<li><p>전파 단계 (BFS)</p>
<ol class="arabic simple">
<li><p>이제 <code class="docutils literal notranslate"><span class="pre">start_id</span></code>가 속한 component전체에 대해, max_row가 작은 이웃 노드들을 best 값으로 끌어올림.</p></li>
<li><p>이 과정을 통해 같은 컴포넌트 안의 모든 골렘이 최대값을 공유</p></li>
<li><p>이렇게 해 두면, 나중에 컴포넌트 안에서 어느 골렘을 시작점으로 잡아도 같은 답을 얻을 수 있습니다.</p></li>
<li><p>다음 골렘을 위해 준비 완료</p></li>
</ol>
</li>
</ol>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span> 

<span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Input.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 

<span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">R</span> <span class="o">+</span> <span class="mi">3</span> 
<span class="n">graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">C</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span><span class="p">)]</span>
<span class="n">id_to_center_dir</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">숲의 바깥방향에서 시작해 골렘의 중아이 c열이 되도록 하는 위치에서 내려옴. </span>
<span class="sd">1) 남쪽 2) 서쪽 rotation + 아래 한 칸 3) 동쪽 rotation + 아래 한칸 </span>
<span class="sd">---&gt; 가장 남쪽 도달 후에는 정령은 골렘 내에서 상하좌우 인접칸으로 이동 가능 </span>
<span class="sd">---&gt; 최종에서 골렘의 몸 일부가 여전히 숲을 벗어난 상태라면 모든 골렘 삭제 및 새롭게 숲  탐색 -&gt; 이 경우 최종 위치를 답에 포함시키지 않음. </span>
<span class="sd">---&gt; 골렘의 출구가 다른 골렘과 인접하다면 해당 출구를 통해 다른 골렘으로 이동 가능 </span>
<span class="sd">----&gt; 정령이 도달하게 되는 최종 위치 누적 </span>
<span class="sd">정령은 어떤 방향에서든 골렘에 탑승 가능, 내릴 때에는 정해진 출구를 통해서만 내릴 수 있음. </span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># 북, 동, 남 ,서 </span>
<span class="n">AY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">AX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">LY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span> <span class="n">LX</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">RY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span> <span class="n">RX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">max_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">y</span> <span class="o">&lt;</span><span class="n">H</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">C</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">in_forest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">H</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">C</span>

<span class="k">def</span><span class="w"> </span><span class="nf">can_move</span><span class="p">(</span><span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span><span class="p">,</span> <span class="n">DIR_Y</span><span class="p">,</span> <span class="n">DIR_X</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">dt_y</span><span class="p">,</span> <span class="n">dt_x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DIR_Y</span><span class="p">,</span> <span class="n">DIR_X</span><span class="p">):</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">dt_y</span> 
        <span class="n">nx</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">dt_x</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">or</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    
    <span class="k">return</span> <span class="kc">True</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">place</span><span class="p">(</span><span class="n">center_y</span><span class="p">,</span> <span class="n">center_x</span><span class="p">,</span> <span class="nb">dir</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">center_y</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">center_x</span>
    
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">can_move</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">DX</span><span class="p">):</span> <span class="c1"># 아래 </span>
            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span> 
            <span class="k">continue</span> 

        <span class="k">if</span> <span class="n">can_move</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">LY</span><span class="p">,</span> <span class="n">LX</span><span class="p">):</span> <span class="c1"># 왼쪽 아래 </span>
            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span> 
            <span class="nb">dir</span> <span class="o">=</span> <span class="p">(</span><span class="nb">dir</span> <span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span>
            <span class="k">continue</span> 
         
        <span class="k">if</span> <span class="n">can_move</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RX</span><span class="p">):</span> <span class="c1"># 오른쪽 아래 </span>
            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span> 
            <span class="nb">dir</span> <span class="o">=</span> <span class="p">(</span><span class="nb">dir</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span>
            <span class="k">continue</span> 

        <span class="c1"># 위의 3가지 경우로 못가는 경우 멈춤 </span>
        <span class="k">break</span> 

    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="nb">dir</span>



<span class="k">def</span><span class="w"> </span><span class="nf">reset_or_settle</span><span class="p">(</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">spirit_id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">id_to_center_dir</span>
    <span class="c1"># reset </span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">AY</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">AX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_forest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">):</span>
            <span class="c1"># reset :graph and id_to_center_dir</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
                    <span class="n">graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 

            <span class="n">id_to_center_dir</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span> 
    <span class="c1"># settle </span>
    <span class="n">graph</span><span class="p">[</span><span class="n">cy</span><span class="p">][</span><span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirit_id</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">ay</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">AY</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">AX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">graph</span><span class="p">[</span><span class="n">ay</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirit_id</span>

    <span class="c1"># id_to_center_dict update </span>
    <span class="n">id_to_center_dir</span><span class="p">[</span><span class="n">spirit_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="nb">dir</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span> 
    
<span class="k">def</span><span class="w"> </span><span class="nf">exit_cell</span><span class="p">(</span><span class="n">id_</span><span class="p">):</span>
    <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cd</span> <span class="o">=</span> <span class="n">id_to_center_dir</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">AY</span><span class="p">[</span><span class="n">cd</span><span class="p">],</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">AX</span><span class="p">[</span><span class="n">cd</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="c1"># 현재 위치 Max값 구하기 </span>
    <span class="n">cy</span> <span class="o">=</span> <span class="n">id_to_center_dir</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="n">id_to_center_dir</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">c_dir</span> <span class="o">=</span> <span class="n">id_to_center_dir</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># exit </span>
    <span class="n">ey</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">AY</span><span class="p">[</span><span class="n">c_dir</span><span class="p">]</span> 
    <span class="n">ex</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">AX</span><span class="p">[</span><span class="n">c_dir</span><span class="p">]</span>
    
    <span class="n">best</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="c1"># 현재 위치에서 골렘 아래 팔로 내려가는 것 - 2(원래 map에서의 column값)이 가장 큰 값 </span>
    <span class="c1"># 현재 골렘의 출구와 연결되어 있는 골렘들의 max값으로 update </span>
    <span class="c1"># 이미 다른 골렘들은 연결되어 있는 골렘들이 가진 max값으로 update되어 있기 때문에 출구에서 4 방향을 보는 것만으로 충분함. </span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="n">ey</span> <span class="o">+</span> <span class="n">AY</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">+</span> <span class="n">AX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">in_forest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">:</span>
            <span class="n">best</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="n">max_values</span><span class="p">[</span><span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]])</span>

    <span class="c1"># 현재 H 행이므로 H = R + 3 인데, 첫 행을 1부터 시작하므로 -3 + 1 해서 -2 </span>
    <span class="n">max_values</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">best</span>

    <span class="c1"># propagate </span>
    <span class="c1"># 현재 골렘 옆에 있는 골렘 값들도 max 값으로 update해주기</span>
    <span class="c1"># 8방향에서 내 쪽으로 들어올 수 있기 때문에, &quot;옆에 출구가 있는 것들에 한해&quot; 업데이트 해주기?! </span>
    <span class="c1"># 연결되어 있지 않은 골렘들이 현재 id에 내려온 골렘때문에 연결될 수 있으므로 propagation </span>
    <span class="n">Neighbor_Y</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">Neighbor_X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># BFS </span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="nb">id</span><span class="p">)])</span> <span class="c1"># center y, x값을 넣어야함. </span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cur_id</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">Neighbor_Y</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">Neighbor_X</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> 
            <span class="k">if</span> <span class="n">in_forest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cur_id</span><span class="p">:</span>
                <span class="c1"># 현재 위치가 다른 골렘의 출구인 경우만, propgate </span>
                <span class="k">if</span> <span class="n">exit_cell</span><span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">])</span> <span class="o">==</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">):</span>
                    <span class="n">n_id</span> <span class="o">=</span> <span class="n">graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">n_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n_id</span><span class="p">)</span>
                        <span class="c1"># update </span>
                        <span class="n">max_values</span><span class="p">[</span><span class="n">n_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_values</span><span class="p">[</span><span class="n">n_id</span><span class="p">],</span> <span class="n">best</span><span class="p">)</span>
                        <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">id_to_center_dir</span><span class="p">[</span><span class="n">n_id</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">id_to_center_dir</span><span class="p">[</span><span class="n">n_id</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_id</span><span class="p">))</span> <span class="c1"># center 값 update </span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">():</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">spirit_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        
        <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># print(f&quot;from {c-1} column&quot;)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">c</span> <span class="o">-</span><span class="mi">1</span> 
        <span class="c1"># place, # 현재 골렘안의 정령이 최대로 갈 수 있는 위치 구하기 </span>
        <span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_dir</span> <span class="o">=</span> <span class="n">place</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c1"># forest밖이면 reset, 아니면 graph및 id_to_center_dirs에 표시 </span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reset_or_settle</span><span class="p">(</span><span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span><span class="p">,</span> <span class="n">cur_dir</span><span class="p">,</span> <span class="n">spirit_id</span><span class="p">):</span>
            <span class="c1"># print(f&quot;max y of {spirit_id}: ignore&quot;)</span>
            <span class="c1"># for row in graph:</span>
            <span class="c1">#     print(row[:])</span>
            <span class="k">continue</span> 

        <span class="n">calculate</span><span class="p">(</span><span class="n">spirit_id</span><span class="p">)</span>
        <span class="c1"># print(f&quot;max y of {spirit_id}: {max_values[spirit_id]}&quot;)</span>
        <span class="c1"># for row in graph:</span>
        <span class="c1">#     print(row[:])</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">max_values</span><span class="p">[</span><span class="n">spirit_id</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="id13">
<h3>블록 이동하기<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">갈 수 있는 방향 설정</p>
<p>아래처럼 길이 나있는 경우가 있을 수 있으므로, 직선으로 움직이는 경우 상하좌우, 회전도 robot의 pivot block 기준으로 가로로 위치한 경우에는 위아래 혹은 세로로 위치한 경우에는 상하로 회전할 수 있도록 해야한다.</p>
<p><img alt="" src="../../_images/0.png" /></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">물체가 2개의 셀 이상 차지하는 경우, 효율적 visited 정보 저장 및 normalization</p>
<p>물체가 차지하는 셀이 1개가 아닌 두개 이기때문에 아래 2가지를 고려해야한다.</p>
<ul class="simple">
<li><p><strong>Visited</strong>: 물체 (Robot)이 차지하는 셀이 한 개 초과 즉, 이경우에는 board에 표시하면 memory가 초과되기 때문에 visited={} set으로 방문 여부를 체크해주면 좋다.</p></li>
<li><p><strong>Normalization</strong>: 상태 정규화(순서 고정)도 존재해야한다. 즉, (y,x,t,v)와 (t,v,y,x)는 같은 로봇 상태인데, visited가 다르게 취급해 중복 상태 폭증하며 시간도 초과된다. 매번 (a,b) 두 좌표를 정렬해서 (small,big)로 저장하거나, frozenset({pos1,pos2})로 관리해야 한다. 즉, 정규화를 통해 (P1, P2) 중 작은 것이 앞에 오도록하여 같은 위치에 있는 로봇의 상태 체크를 잘 할 수 있게 된다.</p></li>
</ul>
<p><img alt="" src="../../_images/111.png" /></p>
<p>When we run BFS, each robot state is represented as the positions of its two blocks and the current time. But we need consistency: which block should be stored first? To avoid duplicates, we always order the two coordinates so that the smaller one comes first. This normalization guarantees that the same robot configuration is stored uniquely in the queue.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">물체의 rotation 및 예상 결과 확인</p>
<p>If the robot is lying horizontally, we can rotate it around either the left block or the right block. Each rotation can go both upward and downward, converting the robot into a vertical orientation. So, in total, we get four possible rotations in this situation.</p>
<p><img alt="" src="../../_images/22.png" /></p>
<p>During rotation, we must check not only the pivot block but also the adjacent cells that the robot sweeps through.</p>
<ul class="simple">
<li><p>If the pivot is the right block, the non-pivot’s upper and lower cells must be empty.</p></li>
<li><p>If the pivot is the left block, again the non-pivot’s upper and lower cells must also be empty.
These checks prevent collisions during rotation.</p></li>
</ul>
<p><img alt="" src="../../_images/32.png" /></p>
<p>After rotation, the final state is defined by the pivot block plus the new block either above or below it.
For example, rotating upward results in the pivot plus the cell above it.
Rotating downward results in the pivot plus the cell below it.
This ensures that we represent the robot’s new vertical position consistently.</p>
<p><img alt="" src="../../_images/42.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># [Left pivot rotation ↑]</span>
<span class="c1">#   Pivot       → (y1, x1)</span>
<span class="c1">#   After move  → {(y1, x1), (y1-1, x1)}</span>
<span class="c1">#   Must check  → (y2-1, x2)</span>

<span class="c1"># [Right pivot rotation ↑]</span>
<span class="c1">#   Pivot       → (y2, x2)</span>
<span class="c1">#   After move  → {(y2-1, x2), (y2, x2)}</span>
<span class="c1">#   Must check  → (y1-1, x1)</span>
</pre></div>
</div>
<p>After rotation, the final state is defined by the pivot block plus the new block either above or below it. For example, rotating upward results in the pivot plus the cell above it.
Rotating downward results in the pivot plus the cell below it.
This ensures that we represent the robot’s new vertical position consistently.</p>
<p><img alt="" src="../../_images/52.png" /></p>
<p>When the robot is vertical, the situation is symmetric.
The pivot can be either the top block or the bottom block.
Each pivot allows a rotation to the left or to the right, changing the robot’s orientation from vertical to horizontal.</p>
<p><img alt="" src="../../_images/61.png" /></p>
<p>As in the horizontal case, rotation requires collision checks.
If the pivot is the bottom block and we rotate left, the non-pivot’s left cell must be empty.
If we rotate right, the non-pivot’s right cell must be empty.
Similarly, when the pivot is the top block, we check the left and right cells of the non-pivot during rotation.
These rules guarantee that rotations happen without intersecting obstacles.</p>
<p><img alt="" src="../../_images/71.png" /></p>
<p>After a vertical rotation, the final state is also described by the pivot plus one adjacent cell.
Rotating left results in the pivot plus its left neighbor.
Rotating right results in the pivot plus its right neighbor.
This completes the transition from vertical to horizontal while preserving a consistent representation.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Complexity</p>
<p>By exploring the state space, we obtain a complexity of <span class="math notranslate nohighlight">\(O(N^2)\)</span>.
The grid size is <span class="math notranslate nohighlight">\(N \times N\)</span>, and the robot can place one of its ends on any cell. This gives <span class="math notranslate nohighlight">\(O(N^2)\)</span> possibilities. Since the robot can exist in two orientations—horizontal and vertical—each cell has two possible states. Therefore, the total number of states is approximately <span class="math notranslate nohighlight">\(O(2 \times N^2)\)</span>, which simplifies to <span class="math notranslate nohighlight">\(O(N^2)\)</span>.</p>
<p>In addition, the number of possible actions from each state is constant: 8 moves in total (4 parallel moves in the four directions, plus 4 rotations — 2 pivots × 2 rotation directions). Thus, each state expands in <span class="math notranslate nohighlight">\(O(1)\)</span>.</p>
<p>Consequently, the overall time complexity is <span class="math notranslate nohighlight">\(O(N^2)\)</span>, and the space complexity is also <span class="math notranslate nohighlight">\(O(N^2)\)</span>.</p>
</div>
<div class="toggle docutils container">
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-number">예시 43 </span><span class="caption-text">Solution</span><a class="headerlink" href="#id17" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">제한사항 </span>
<span class="sd">5 &lt;= N &lt;= 100 </span>
<span class="sd">BFS -&gt; O(NxN), 각 칸에 대해 2가지 방향, 각 상태에서 상수개 액션 </span>
<span class="sd"># 장애물이 있으면 왼쪽/위쪽으로 돌아가야하므로 4방향 모두 탐색해야함. </span>
<span class="sd"># 회전도 양방향 회전 전부 고려해야함. </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">solution</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">n</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">neighbors</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
        <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span>
        <span class="n">cand</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># 1) 4방향 평이동</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dx</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="n">ny1</span><span class="p">,</span> <span class="n">nx1</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">,</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span>
            <span class="n">ny2</span><span class="p">,</span> <span class="n">nx2</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">dy</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">dx</span>
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny1</span><span class="p">,</span> <span class="n">nx1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny2</span><span class="p">,</span> <span class="n">nx2</span><span class="p">)</span> \
               <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">ny1</span><span class="p">][</span><span class="n">nx1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">ny2</span><span class="p">][</span><span class="n">nx2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cand</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">ny1</span><span class="p">,</span> <span class="n">nx1</span><span class="p">),</span> <span class="p">(</span><span class="n">ny2</span><span class="p">,</span> <span class="n">nx2</span><span class="p">)))</span>

        <span class="c1"># 2) 회전 (가로 ↔ 세로)</span>
        <span class="k">if</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>  <span class="c1"># 가로일 때 → 세로로 회전</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>  <span class="c1"># 위/아래</span>
                <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_range</span><span class="p">(</span><span class="n">y2</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> \
                   <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">y1</span> <span class="o">+</span> <span class="n">d</span><span class="p">][</span><span class="n">x1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">y2</span> <span class="o">+</span> <span class="n">d</span><span class="p">][</span><span class="n">x2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 왼쪽 블록 기준 회전</span>
                    <span class="n">cand</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">x1</span><span class="p">)))</span>
                    <span class="c1"># 오른쪽 블록 기준 회전</span>
                    <span class="n">cand</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y2</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">x2</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span><span class="p">:</span>  <span class="c1"># 세로일 때 → 가로로 회전</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>  <span class="c1"># 좌/우</span>
                <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_range</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> \
                   <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">y1</span><span class="p">][</span><span class="n">x1</span> <span class="o">+</span> <span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">y2</span><span class="p">][</span><span class="n">x2</span> <span class="o">+</span> <span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 위쪽 블록 기준 회전</span>
                    <span class="n">cand</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">d</span><span class="p">)))</span>
                    <span class="c1"># 아래쪽 블록 기준 회전</span>
                    <span class="n">cand</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">d</span><span class="p">)))</span>

        <span class="c1"># 상태 정규화 (작은 좌표가 앞으로)</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">cand</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">norm</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">norm</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">norm</span>

    <span class="c1"># 3) BFS 시작</span>
    <span class="n">start</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># 시작 상태</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="p">{</span><span class="n">start</span><span class="p">}</span> <span class="c1"># visited도 graph위에 체크하는 것이 아닌, Set으로 관리하여 메모리 효율적으로 관리 </span>

    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">t</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">p1</span> <span class="o">==</span> <span class="n">goal</span> <span class="ow">or</span> <span class="n">p2</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="k">for</span> <span class="n">nxt</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">nxt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">nxt</span><span class="p">)</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nxt</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># 도달 불가</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Expected 7</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">board</span><span class="p">))</span>

    <span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Expected 1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">board</span><span class="p">))</span>

    <span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Expected 3</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">board</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>고대 문명 유적 탐사<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<div class="dropdown admonition">
<p class="admonition-title">리스트의 복사</p>
<h3 class="rubric" id="id15">리스트의 복사</h3>
<ul class="simple">
<li><p>1차원 리스트 같은 경우에는 <code class="docutils literal notranslate"><span class="pre">[:]</span></code>로 복사하면 된다.</p></li>
<li><p>2차원 리스트는 [:]로 복사하면 얕은 복사라서, 내부 행 리스트를 공유하게 된다. 따라서 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">copy</span> <span class="pre">import</span> <span class="pre">deepcopy</span></code>를 사용하거나 <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">comprehension</span></code>를 사용하면 된다. 예를 들어 다음 코드와 같이 할 수 있다.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>

<span class="c1"># 깊은 복사</span>
<span class="n">copied</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">]</span>

<span class="n">copied</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>   <span class="c1"># [[1, 2], [3, 4]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">copied</span><span class="p">)</span> <span class="c1"># [[99, 2], [3, 4]]</span>
</pre></div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Rotation around a center</p>
<p>이번 문제에서는 center가 변화하면서 rotation을 수행해야하기 때문에, 해당 center에서 3x3 rotation을 직접 종이에 적어본 후, 행열이 각각 어떻게 변하는지 <code class="docutils literal notranslate"><span class="pre">예상</span> <span class="pre">결과</span></code>와 동일한지 하나하나 따져가며 구현해야한다. 말그대로 구현 문제!</p>
<p>즉, 5x5 행렬에서는 총 9개의 센터가 존재하고, 각 센터마다 90 -&gt; 180 -&gt; 270 회전 (27번) 중에서 가장 우선순위가 높은 것만 저장하면 된다.
또한, 각 센터에서 90 회전 다음에 또 90회전을 하면 180도이므로 CW 90도 회전 한 번을 구현해놓으면 코드가 간단해진다.</p>
<p>center가 (1,1)일때 CW 90도 회전 이후 결과
<img alt="" src="../../_images/81.png" /> <br>
center가 (1,2)일때 CW 90도 회전 이후 결과
<img alt="" src="../../_images/9.png" /> <br>
center가 (1,3)일때 CW 90도 회전 이후 결과
<img alt="" src="../../_images/10.png" /> <br>
center가 (2,1)일때 CW 90도 회전 이후 결과
<img alt="" src="../../_images/1111.png" /> <br></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title"><a class="reference external" href="http://rotation.py">rotation.py</a> degugging file</p>
<p>아래 파일을 따로 만들어서, 실제 로테이션이 잘 되는지 확인하였다. 문제를 풀 때 solve()함수는 다양한 함수들로 이루어져있어, 디버깅이 복잡하다. 따라서, 하나의 함수마다 degugging은 이런 식으로 별도로 output을 출력해서 확인하면 쉬워진다.</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-number">예시 44 </span><span class="caption-text"><a class="reference external" href="http://rotation.py">rotation.py</a> (debug)</span><a class="headerlink" href="#id18" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">in_circle</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cy</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">cy</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cx</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">cx</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_function</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">:</span>
        <span class="n">local_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">]</span>
        <span class="n">previous_local_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_graph</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Graph&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_graph</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">rotation_cnt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">cy</span> <span class="ow">and</span> <span class="n">x</span><span class="o">==</span><span class="n">cx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_circle</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">):</span>
                        <span class="n">add_num</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">cx</span> 
                        <span class="n">x_minus_y</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">cy</span> 
                        <span class="n">local_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_local_graph</span><span class="p">[</span><span class="n">add_num</span><span class="o">-</span><span class="n">x</span><span class="p">][</span><span class="n">y</span> <span class="o">+</span> <span class="n">x_minus_y</span><span class="p">]</span> <span class="c1"># CW 90도 회전 </span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">local_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_local_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Center </span><span class="si">{</span><span class="n">cy</span><span class="p">,</span><span class="w"> </span><span class="n">cx</span><span class="si">}</span><span class="s2">, CW </span><span class="si">{</span><span class="mi">90</span><span class="o">*</span><span class="p">(</span><span class="n">rotation_cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> degree : &quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_graph</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

            <span class="n">previous_local_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_graph</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">local_graph</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">global</span> <span class="n">graph</span> 
    <span class="n">graph</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
    <span class="p">]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">my_function</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-number">예시 45 </span><span class="caption-text">Output of <a class="reference external" href="http://rotation.py">rotation.py</a></span><a class="headerlink" href="#id19" title="Link to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 1), CW 90 degree : 
    [7, 4, 1, 10, 11]
    [8, 5, 2, 12, 13]
    [9, 6, 3, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 1), CW 180 degree : 
    [9, 8, 7, 10, 11]
    [6, 5, 4, 12, 13]
    [3, 2, 1, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 1), CW 270 degree : 
    [3, 6, 9, 10, 11]
    [2, 5, 8, 12, 13]
    [1, 4, 7, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 2), CW 90 degree : 
    [1, 8, 5, 2, 11]
    [4, 9, 6, 3, 13]
    [7, 14, 12, 10, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 2), CW 180 degree : 
    [1, 14, 9, 8, 11]
    [4, 12, 6, 5, 13]
    [7, 10, 3, 2, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 2), CW 270 degree : 
    [1, 10, 12, 14, 11]
    [4, 3, 6, 9, 13]
    [7, 2, 5, 8, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 3), CW 90 degree : 
    [1, 2, 9, 6, 3]
    [4, 5, 14, 12, 10]
    [7, 8, 15, 13, 11]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 3), CW 180 degree : 
    [1, 2, 15, 14, 9]
    [4, 5, 13, 12, 6]
    [7, 8, 11, 10, 3]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (1, 3), CW 270 degree : 
    [1, 2, 11, 13, 15]
    [4, 5, 10, 12, 14]
    [7, 8, 3, 6, 9]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (2, 1), CW 90 degree : 
    [1, 2, 3, 10, 11]
    [16, 7, 4, 12, 13]
    [17, 8, 5, 14, 15]
    [18, 9, 6, 19, 20]
    [20, 21, 22, 23, 24]
    Center (2, 1), CW 180 degree : 
    [1, 2, 3, 10, 11]
    [18, 17, 16, 12, 13]
    [9, 8, 7, 14, 15]
    [6, 5, 4, 19, 20]
    [20, 21, 22, 23, 24]
    Center (2, 1), CW 270 degree : 
    [1, 2, 3, 10, 11]
    [6, 9, 18, 12, 13]
    [5, 8, 17, 14, 15]
    [4, 7, 16, 19, 20]
    [20, 21, 22, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (2, 2), CW 90 degree : 
    [1, 2, 3, 10, 11]
    [4, 17, 8, 5, 13]
    [7, 18, 9, 6, 15]
    [16, 19, 14, 12, 20]
    [20, 21, 22, 23, 24]
    Center (2, 2), CW 180 degree : 
    [1, 2, 3, 10, 11]
    [4, 19, 18, 17, 13]
    [7, 14, 9, 8, 15]
    [16, 12, 6, 5, 20]
    [20, 21, 22, 23, 24]
    Center (2, 2), CW 270 degree : 
    [1, 2, 3, 10, 11]
    [4, 12, 14, 19, 13]
    [7, 6, 9, 18, 15]
    [16, 5, 8, 17, 20]
    [20, 21, 22, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (2, 3), CW 90 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 18, 9, 6]
    [7, 8, 19, 14, 12]
    [16, 17, 20, 15, 13]
    [20, 21, 22, 23, 24]
    Center (2, 3), CW 180 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 20, 19, 18]
    [7, 8, 15, 14, 9]
    [16, 17, 13, 12, 6]
    [20, 21, 22, 23, 24]
    Center (2, 3), CW 270 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 13, 15, 20]
    [7, 8, 12, 14, 19]
    [16, 17, 6, 9, 18]
    [20, 21, 22, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (3, 1), CW 90 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [20, 16, 7, 14, 15]
    [21, 17, 8, 19, 20]
    [22, 18, 9, 23, 24]
    Center (3, 1), CW 180 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [22, 21, 20, 14, 15]
    [18, 17, 16, 19, 20]
    [9, 8, 7, 23, 24]
    Center (3, 1), CW 270 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [9, 18, 22, 14, 15]
    [8, 17, 21, 19, 20]
    [7, 16, 20, 23, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (3, 2), CW 90 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 21, 17, 8, 15]
    [16, 22, 18, 9, 20]
    [20, 23, 19, 14, 24]
    Center (3, 2), CW 180 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 23, 22, 21, 15]
    [16, 19, 18, 17, 20]
    [20, 14, 9, 8, 24]
    Center (3, 2), CW 270 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 14, 19, 23, 15]
    [16, 9, 18, 22, 20]
    [20, 8, 17, 21, 24]
    Original Graph
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 9, 14, 15]
    [16, 17, 18, 19, 20]
    [20, 21, 22, 23, 24]
    Center (3, 3), CW 90 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 22, 18, 9]
    [16, 17, 23, 19, 14]
    [20, 21, 24, 20, 15]
    Center (3, 3), CW 180 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 24, 23, 22]
    [16, 17, 20, 19, 18]
    [20, 21, 15, 14, 9]
    Center (3, 3), CW 270 degree : 
    [1, 2, 3, 10, 11]
    [4, 5, 6, 12, 13]
    [7, 8, 15, 20, 24]
    [16, 17, 14, 19, 23]
    [20, 21, 9, 18, 22]
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5x5중에서 3x3격자 선택 및 회전 CW: 90도, 180도, 270도 </span>
<span class="c1"># 향상 회전 : 중심좌표를 기준으로 90도 회전 </span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">### 탐사 진행: 회전 목표 </span>
<span class="sd">1)유물 1차 회득 가치 최대화</span>
<span class="sd">2) 1)의 방법이 여러개이면, 회전한 각도 중 가장 작은 각도 선택</span>
<span class="sd">3) 2)의 방법도 여러가지이면 (회전 중심좌표가 다를 수 있음), 회전 중심 좌표의 열이 가장 작은 구간 선택 </span>
<span class="sd">4) 열이 같다면 행이 가장 작은 구간 선택 </span>

<span class="sd">### 유물 1차 획득 </span>
<span class="sd">- 유물의 가치: 5x5행렬에서 모인 조각의 개수 -&gt; &quot;3개 이상&quot;부터 획득 가능  </span>
<span class="sd">- 유물이 사라짐. </span>
<span class="sd">- 새로들어오는 유물은 유적의 벽면에 써 있는 숫자대로 진행 (row up, column up순으로 채워짐)</span>
<span class="sd">- 사용된 숫자다음부터 다음에 사용할 수 있음 </span>

<span class="sd">#### 유물 연쇄 획득 </span>
<span class="sd">- 새로운 유물 조각이 생겨난 이후에도 유물이 있으면 조각을 획득하고 없앤후 다시 채움.</span>
<span class="sd">- 다만 더 이상 조각이 3개 이상 연결되지 않아 유물이 될 수 없으면 멈춤 </span>

<span class="sd">#### 탐사 반복 </span>
<span class="sd">- 탐사 진행 -&gt; 유물 1차 획득 -&gt; 유믈 연쇄 획득 과정까지 1턴이며 총 K번 턴을 돌림. </span>
<span class="sd">- 1번의 turn에서 K번 이전에 어떠한 방법을 사용해서라도 유물을 획득할 수 없다면, 모든 탐사는 그 즉시 종료됨. </span>
<span class="sd">이 경우 얻을 수 있는 유물이 존재하지 않으므로, 종료되는 턴에 아무 값도 출력하지 않음. </span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">():</span>

    <span class="c1"># f = open(&#39;/Users/dayelee/Documents/GitHub/mybook/Input.txt&#39;, &#39;r&#39;)</span>
    <span class="n">K</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">global</span> <span class="n">graph</span><span class="p">,</span> <span class="n">parts</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>

    <span class="c1"># 유물조각은 들어온 순서부터 pop</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>

    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Step 1: </span>
        <span class="c1"># 3x3을 회전: 총 9개 위치를 중심으로 CW 90, 180, 270도 (9 * 3=27)개 중 선택, 유물은 조각 3개 이상 연결 </span>
        <span class="c1"># 유적위치 locs = list(), 유물의 가치 = len(locs), </span>
        <span class="n">locs</span><span class="p">,</span> <span class="n">result_graph</span> <span class="o">=</span> <span class="n">explore</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span> <span class="c1"># 유적의 가치가 없으면 K 턴 전에 stop </span>
        
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="c1"># 유물의 가치 더하기 </span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">result_graph</span><span class="p">[:]</span> <span class="c1"># 유적 graph update </span>

        <span class="c1"># global graph에 유적 위치 Locs에 새로운 조각 update </span>
        <span class="n">update_graph</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
        
        <span class="c1"># global graph에 유물 연쇄 획득 과정 </span>
        <span class="n">value</span><span class="o">=</span> <span class="n">get_chained_parts</span><span class="p">()</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">value</span> 

        <span class="c1"># 공백을 사이에 두고 출력 </span>
        <span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="n">fy</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rx</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">fx</span> <span class="o">!=</span> <span class="n">rx</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">fx</span> <span class="o">&lt;</span> <span class="n">rx</span>   <span class="c1"># 열 번호가 작은 순 </span>
    <span class="k">elif</span> <span class="n">fy</span> <span class="o">!=</span> <span class="n">ry</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fy</span> <span class="o">&gt;</span> <span class="n">ry</span>  <span class="c1"># 행 번호가 큰 순 </span>
    <span class="k">return</span> <span class="kc">True</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">sort_locs</span><span class="p">(</span><span class="n">locs</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    ascending order </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f_pointer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">lowest_pointer</span> <span class="o">=</span> <span class="n">f_pointer</span> 
        <span class="k">for</span> <span class="n">r_pointer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">f_pointer</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">locs</span><span class="p">[</span><span class="n">lowest_pointer</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">locs</span><span class="p">[</span><span class="n">lowest_pointer</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">locs</span><span class="p">[</span><span class="n">r_pointer</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">locs</span><span class="p">[</span><span class="n">r_pointer</span><span class="p">][</span><span class="mi">1</span><span class="p">]):</span>
                <span class="c1"># 저장 </span>
                <span class="n">lowest_pointer</span> <span class="o">=</span> <span class="n">r_pointer</span> 
        <span class="c1"># swap </span>
        <span class="k">if</span> <span class="n">lowest_pointer</span> <span class="o">!=</span> <span class="n">f_pointer</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="n">lowest_pointer</span><span class="p">]</span>
            <span class="n">locs</span><span class="p">[</span><span class="n">lowest_pointer</span><span class="p">]</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="n">f_pointer</span><span class="p">]</span>
            <span class="n">locs</span><span class="p">[</span><span class="n">f_pointer</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span> 


<span class="k">def</span><span class="w"> </span><span class="nf">update_graph</span><span class="p">(</span><span class="n">locs</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">graph</span><span class="p">,</span> <span class="n">parts</span> 

    <span class="n">sort_locs</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="c1"># call by reference </span>
    <span class="c1"># 정렬 순서대로 update </span>
    <span class="k">for</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
        <span class="n">graph</span><span class="p">[</span><span class="n">cy</span><span class="p">][</span><span class="n">cx</span><span class="p">]</span> <span class="o">=</span> <span class="n">parts</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>



<span class="k">def</span><span class="w"> </span><span class="nf">in_circle</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cy</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">cy</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cx</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">cx</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">explore</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">graph</span>
    <span class="c1"># 열이 가장 작고 -&gt; 행이 가장 작은 순으로 배열  </span>
    <span class="c1"># centers = [(1, 1), (1, 2), (1, 3), (2,1), (2,2), (2, 3), (3, 1), (3, 2), (3, 3)]</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

    <span class="n">max_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_locs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">min_rotation</span> <span class="o">=</span> <span class="mi">99999999</span> 
    <span class="n">result_graph</span> <span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">:</span>
        <span class="n">local_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">]</span>
        <span class="n">previous_local_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_graph</span><span class="p">]</span>
        <span class="c1"># 90, 180, 270 CW rotation </span>
        <span class="k">for</span> <span class="n">rotation_cnt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="c1"># 회전 후의 새로운 graph생성 </span>
            <span class="n">add_num</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">cx</span> 
            <span class="n">x_minus_y</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">cy</span> 
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                    <span class="c1"># if (y!=cy and x!=cx) and in_circle(y, x, cy, cx):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">cy</span> <span class="ow">and</span> <span class="n">x</span><span class="o">==</span><span class="n">cx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_circle</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">cx</span><span class="p">):</span>
                        <span class="n">local_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_local_graph</span><span class="p">[</span><span class="n">add_num</span><span class="o">-</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="o">+</span><span class="n">x_minus_y</span><span class="p">]</span> <span class="c1"># CW 90도 회전 </span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">local_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_local_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>

            <span class="c1"># 이전 rotaed graph update </span>
            <span class="n">previous_local_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_graph</span><span class="p">]</span>

            <span class="c1"># rotation 후 고정된 Graph에서 3개 이상 모여있는 유물의 위치 계산</span>
            <span class="n">cur_locs</span> <span class="o">=</span> <span class="n">calculate_values</span><span class="p">(</span><span class="n">previous_local_graph</span><span class="p">)</span>
            
            <span class="c1"># locs, rotation_cnt비교 </span>
            <span class="c1"># 각도가 작은 것이 제일 먼저 priority : 각도가 같으면, 열 -&gt; 행 순서대로 이미 적용되어있기 때문에, 가치가 더 클때만 바꾼다. </span>
            <span class="c1"># 따라서 오직 이전것보다 큰 경우에만 update (같으면 앞의 것으로 함.)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_locs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_value</span><span class="p">:</span> <span class="c1"># Step 1: 유물 가치가 가장 높은 것을 최대화 </span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_locs</span><span class="p">)</span> <span class="o">==</span> <span class="n">max_value</span><span class="p">:</span> <span class="c1"># Step 2: Step 1이 여러개라면, 회전 각도가 가장 작은 것 </span>
                    <span class="k">if</span> <span class="n">min_rotation</span> <span class="o">&gt;</span> <span class="n">rotation_cnt</span><span class="p">:</span>
                        <span class="c1"># update </span>
                        <span class="n">min_rotation</span> <span class="o">=</span> <span class="n">rotation_cnt</span> 
                        <span class="n">max_value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_locs</span><span class="p">)</span>
                        <span class="n">max_locs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cur_locs</span><span class="p">)</span>
                        <span class="n">result_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">previous_local_graph</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># update </span>
                    <span class="n">min_rotation</span> <span class="o">=</span> <span class="n">rotation_cnt</span> 
                    <span class="n">max_value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_locs</span><span class="p">)</span>
                    <span class="n">max_locs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cur_locs</span><span class="p">)</span>
                    <span class="n">result_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">previous_local_graph</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">max_locs</span><span class="p">,</span><span class="n">result_graph</span>

<span class="k">def</span><span class="w"> </span><span class="nf">in_range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&lt;</span><span class="mi">5</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">BFS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cur_graph</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)])</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">DY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">DX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">cur_y</span><span class="p">,</span> <span class="n">cur_x</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">cur_y</span> <span class="o">+</span> <span class="n">DY</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">cur_x</span> <span class="o">+</span> <span class="n">DX</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> 
            <span class="c1"># range안에 있고 &amp; 원래 y, x 안에 있는 수와 옆의 수가 동일한지 &amp; 방문하지는 않았는지 </span>
            <span class="k">if</span> <span class="n">in_range</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cur_graph</span><span class="p">[</span><span class="n">ny</span><span class="p">][</span><span class="n">nx</span><span class="p">]</span> <span class="o">==</span> <span class="n">cur_graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">):</span>
                <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span><span class="n">nx</span><span class="p">))</span>

    <span class="c1"># 3개 이상인지 </span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">visited</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">visited</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_values</span><span class="p">(</span><span class="n">cur_graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    고정된 Graph에서 3개 이상 모여있는 유물의 위치 계산</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">is_more_three</span><span class="p">,</span> <span class="n">locs</span> <span class="o">=</span> <span class="n">BFS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cur_graph</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_more_three</span><span class="p">:</span>
                <span class="c1"># set을 extend하는 방법? </span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
                    
    <span class="k">return</span> <span class="n">result</span> 
            

<span class="k">def</span><span class="w"> </span><span class="nf">get_chained_parts</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">graph</span> 
    <span class="n">values</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># 유적 위치 세기 </span>
        <span class="n">locs</span> <span class="o">=</span> <span class="n">calculate_values</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span> 
 
        <span class="n">values</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> 

        <span class="c1"># 유적 graph 업데이트하기 </span>
        <span class="n">update_graph</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">locs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">values</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./_pages/practice"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1_implementationPS.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">이전</p>
        <p class="prev-next-title">Lecture 1-2. 구현 실습</p>
      </div>
    </a>
    <a class="right-next"
       href="3_backtrackingPS.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">다음</p>
        <p class="prev-next-title">Lecture 3-2. Backtracking 실습</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 내용
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bfs-kit">BFS 고득점 Kit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">타겟 넘버</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">네트워크</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">게임 맵 최단 거리</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">단어 변환</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">아이템 줍기</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">여행 경로</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">퍼즐 조각 채우기</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bfs">BFS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ai">AI 로봇 청소기</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">미생물 연구</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">민트초코 우유</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">메두사와 전사들</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">미지의 공간 탈출</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">마법의 숲 탐색</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">블록 이동하기</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">고대 문명 유적 탐사</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
으로 Daye Lee
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>